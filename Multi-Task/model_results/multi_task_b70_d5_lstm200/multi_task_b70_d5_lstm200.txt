______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_26 (InputLayer)                            (None, 73, 54)                   0                                                                   
______________________________________________________________________________________________________________________________________________________
char_embedding (TimeDistributed)                 (None, 73, 54, 100)              16500             input_26[0][0]                                    
______________________________________________________________________________________________________________________________________________________
dropout_37 (Dropout)                             (None, 73, 54, 100)              0                 char_embedding[0][0]                              
______________________________________________________________________________________________________________________________________________________
input_25 (InputLayer)                            (None, 73)                       0                                                                   
______________________________________________________________________________________________________________________________________________________
time_distributed_25 (TimeDistributed)            (None, 73, 54, 50)               25200             dropout_37[0][0]                                  
______________________________________________________________________________________________________________________________________________________
embedding_25 (Embedding)                         (None, 73, 300)                  17130300          input_25[0][0]                                    
______________________________________________________________________________________________________________________________________________________
time_distributed_26 (TimeDistributed)            (None, 73, 2700)                 0                 time_distributed_25[0][0]                         
______________________________________________________________________________________________________________________________________________________
concatenate_13 (Concatenate)                     (None, 73, 3000)                 0                 embedding_25[0][0]                                
                                                                                                    time_distributed_26[0][0]                         
______________________________________________________________________________________________________________________________________________________
dropout_38 (Dropout)                             (None, 73, 3000)                 0                 concatenate_13[0][0]                              
______________________________________________________________________________________________________________________________________________________
bidirectional_26 (Bidirectional)                 (None, 73, 400)                  5121600           dropout_38[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dropout_39 (Dropout)                             (None, 73, 400)                  0                 bidirectional_26[0][0]                            
______________________________________________________________________________________________________________________________________________________
dense_37 (Dense)                                 (None, 73, 28)                   11228             dropout_39[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_38 (Dense)                                 (None, 73, 11)                   4411              dropout_39[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_39 (Dense)                                 (None, 73, 5)                    2005              dropout_39[0][0]                                  
______________________________________________________________________________________________________________________________________________________
crf_37 (CRF)                                     (None, 73, 28)                   1652              dense_37[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_38 (CRF)                                     (None, 73, 11)                   275               dense_38[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_39 (CRF)                                     (None, 73, 5)                    65                dense_39[0][0]                                    
======================================================================================================================================================
Total params: 22,313,236
Trainable params: 22,313,236
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
None 




Train on 49616 samples, validate on 2258 samples
Epoch 1/25
 - 1648s - loss: 0.5182 - crf_37_loss: 0.2382 - crf_38_loss: 0.1841 - crf_39_loss: 0.0959 - crf_37_acc_1: 0.9264 - crf_37_acc_2: 0.7717 - crf_37_acc_3: 0.7748 - crf_38_acc_1: 0.7704 - crf_38_acc_2: 0.9196 - crf_38_acc_3: 0.7733 - crf_39_acc_1: 0.7725 - crf_39_acc_2: 0.7718 - crf_39_acc_3: 0.9654 - val_loss: 0.1504 - val_crf_37_loss: 0.0757 - val_crf_38_loss: 0.0626 - val_crf_39_loss: 0.0121 - val_crf_37_acc_1: 0.9706 - val_crf_37_acc_2: 0.8133 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8135 - val_crf_38_acc_2: 0.9547 - val_crf_38_acc_3: 0.8155 - val_crf_39_acc_1: 0.8132 - val_crf_39_acc_2: 0.8155 - val_crf_39_acc_3: 0.9904 - val_f1: 0.8469 - val_crf_37_f1: 0.8355 - val_crf_38_f1: 0.7592 - val_crf_39_f1: 0.9461
Epoch 2/25
 - 1621s - loss: 0.1576 - crf_37_loss: 0.0862 - crf_38_loss: 0.0543 - crf_39_loss: 0.0171 - crf_37_acc_1: 0.9580 - crf_37_acc_2: 0.7723 - crf_37_acc_3: 0.7756 - crf_38_acc_1: 0.7722 - crf_38_acc_2: 0.9488 - crf_38_acc_3: 0.7738 - crf_39_acc_1: 0.7751 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9823 - val_loss: 0.0587 - val_crf_37_loss: 0.0386 - val_crf_38_loss: 0.0226 - val_crf_39_loss: -2.5448e-03 - val_crf_37_acc_1: 0.9729 - val_crf_37_acc_2: 0.8133 - val_crf_37_acc_3: 0.8134 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9569 - val_crf_38_acc_3: 0.8151 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8152 - val_crf_39_acc_3: 0.9874 - val_f1: 0.8604 - val_crf_37_f1: 0.8640 - val_crf_38_f1: 0.7759 - val_crf_39_f1: 0.9412
Epoch 3/25
 - 1635s - loss: 0.0602 - crf_37_loss: 0.0470 - crf_38_loss: 0.0187 - crf_39_loss: -5.5361e-03 - crf_37_acc_1: 0.9631 - crf_37_acc_2: 0.7723 - crf_37_acc_3: 0.7755 - crf_38_acc_1: 0.7722 - crf_38_acc_2: 0.9536 - crf_38_acc_3: 0.7736 - crf_39_acc_1: 0.7752 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9840 - val_loss: 0.0018 - val_crf_37_loss: 0.0166 - val_crf_38_loss: 0.0017 - val_crf_39_loss: -1.6467e-02 - val_crf_37_acc_1: 0.9769 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8134 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9585 - val_crf_38_acc_3: 0.8153 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8149 - val_crf_39_acc_3: 0.9885 - val_f1: 0.8655 - val_crf_37_f1: 0.8778 - val_crf_38_f1: 0.7783 - val_crf_39_f1: 0.9404
Epoch 4/25
 - 1620s - loss: 0.0041 - crf_37_loss: 0.0247 - crf_38_loss: -8.3779e-04 - crf_39_loss: -1.9743e-02 - crf_37_acc_1: 0.9656 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7722 - crf_38_acc_2: 0.9560 - crf_38_acc_3: 0.7735 - crf_39_acc_1: 0.7752 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9845 - val_loss: -3.7483e-02 - val_crf_37_loss: 0.0027 - val_crf_38_loss: -1.2866e-02 - val_crf_39_loss: -2.7316e-02 - val_crf_37_acc_1: 0.9751 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8134 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9636 - val_crf_38_acc_3: 0.8154 - val_crf_39_acc_1: 0.8136 - val_crf_39_acc_2: 0.8151 - val_crf_39_acc_3: 0.9884 - val_f1: 0.8741 - val_crf_37_f1: 0.8736 - val_crf_38_f1: 0.8096 - val_crf_39_f1: 0.9391
Epoch 5/25
 - 1615s - loss: -3.8138e-02 - crf_37_loss: 0.0086 - crf_38_loss: -1.5204e-02 - crf_39_loss: -3.1528e-02 - crf_37_acc_1: 0.9670 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7722 - crf_38_acc_2: 0.9581 - crf_38_acc_3: 0.7735 - crf_39_acc_1: 0.7752 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9844 - val_loss: -7.2169e-02 - val_crf_37_loss: -1.0432e-02 - val_crf_38_loss: -2.3866e-02 - val_crf_39_loss: -3.7871e-02 - val_crf_37_acc_1: 0.9777 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9607 - val_crf_38_acc_3: 0.8153 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8154 - val_crf_39_acc_3: 0.9892 - val_f1: 0.8717 - val_crf_37_f1: 0.8813 - val_crf_38_f1: 0.7921 - val_crf_39_f1: 0.9418
Epoch 6/25
 - 1619s - loss: -7.4141e-02 - crf_37_loss: -4.6935e-03 - crf_38_loss: -2.7166e-02 - crf_39_loss: -4.2281e-02 - crf_37_acc_1: 0.9682 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7722 - crf_38_acc_2: 0.9596 - crf_38_acc_3: 0.7735 - crf_39_acc_1: 0.7752 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9842 - val_loss: -1.0890e-01 - val_crf_37_loss: -2.1875e-02 - val_crf_38_loss: -3.7430e-02 - val_crf_39_loss: -4.9599e-02 - val_crf_37_acc_1: 0.9779 - val_crf_37_acc_2: 0.8131 - val_crf_37_acc_3: 0.8134 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9673 - val_crf_38_acc_3: 0.8151 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8152 - val_crf_39_acc_3: 0.9886 - val_f1: 0.8796 - val_crf_37_f1: 0.8827 - val_crf_38_f1: 0.8250 - val_crf_39_f1: 0.9310
Epoch 7/25
 - 1619s - loss: -1.0772e-01 - crf_37_loss: -1.6757e-02 - crf_38_loss: -3.8270e-02 - crf_39_loss: -5.2693e-02 - crf_37_acc_1: 0.9694 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7721 - crf_38_acc_2: 0.9610 - crf_38_acc_3: 0.7735 - crf_39_acc_1: 0.7753 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9842 - val_loss: -1.3943e-01 - val_crf_37_loss: -3.2223e-02 - val_crf_38_loss: -4.7661e-02 - val_crf_39_loss: -5.9548e-02 - val_crf_37_acc_1: 0.9787 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9674 - val_crf_38_acc_3: 0.8151 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8149 - val_crf_39_acc_3: 0.9881 - val_f1: 0.8786 - val_crf_37_f1: 0.8862 - val_crf_38_f1: 0.8243 - val_crf_39_f1: 0.9252
Epoch 8/25
 - 1620s - loss: -1.3900e-01 - crf_37_loss: -2.7521e-02 - crf_38_loss: -4.8673e-02 - crf_39_loss: -6.2805e-02 - crf_37_acc_1: 0.9700 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7721 - crf_38_acc_2: 0.9622 - crf_38_acc_3: 0.7734 - crf_39_acc_1: 0.7753 - crf_39_acc_2: 0.7730 - crf_39_acc_3: 0.9842 - val_loss: -1.6477e-01 - val_crf_37_loss: -4.2234e-02 - val_crf_38_loss: -5.5028e-02 - val_crf_39_loss: -6.7511e-02 - val_crf_37_acc_1: 0.9786 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9640 - val_crf_38_acc_3: 0.8152 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8155 - val_crf_39_acc_3: 0.9855 - val_f1: 0.8681 - val_crf_37_f1: 0.8851 - val_crf_38_f1: 0.8106 - val_crf_39_f1: 0.9086
Epoch 9/25
 - 1619s - loss: -1.6992e-01 - crf_37_loss: -3.8260e-02 - crf_38_loss: -5.8866e-02 - crf_39_loss: -7.2791e-02 - crf_37_acc_1: 0.9709 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7753 - crf_38_acc_1: 0.7721 - crf_38_acc_2: 0.9634 - crf_38_acc_3: 0.7734 - crf_39_acc_1: 0.7753 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9842 - val_loss: -1.9378e-01 - val_crf_37_loss: -5.1775e-02 - val_crf_38_loss: -6.4834e-02 - val_crf_39_loss: -7.7170e-02 - val_crf_37_acc_1: 0.9790 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8134 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9657 - val_crf_38_acc_3: 0.8151 - val_crf_39_acc_1: 0.8134 - val_crf_39_acc_2: 0.8154 - val_crf_39_acc_3: 0.9859 - val_f1: 0.8704 - val_crf_37_f1: 0.8870 - val_crf_38_f1: 0.8184 - val_crf_39_f1: 0.9059
Epoch 10/25
 - 1636s - loss: -1.9994e-01 - crf_37_loss: -4.8376e-02 - crf_38_loss: -6.8869e-02 - crf_39_loss: -8.2699e-02 - crf_37_acc_1: 0.9713 - crf_37_acc_2: 0.7722 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7721 - crf_38_acc_2: 0.9647 - crf_38_acc_3: 0.7734 - crf_39_acc_1: 0.7753 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9842 - val_loss: -2.2382e-01 - val_crf_37_loss: -6.1342e-02 - val_crf_38_loss: -7.5143e-02 - val_crf_39_loss: -8.7331e-02 - val_crf_37_acc_1: 0.9796 - val_crf_37_acc_2: 0.8130 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9664 - val_crf_38_acc_3: 0.8153 - val_crf_39_acc_1: 0.8135 - val_crf_39_acc_2: 0.8153 - val_crf_39_acc_3: 0.9852 - val_f1: 0.8726 - val_crf_37_f1: 0.8903 - val_crf_38_f1: 0.8228 - val_crf_39_f1: 0.9046
Epoch 11/25
 - 1619s - loss: -2.2967e-01 - crf_37_loss: -5.8346e-02 - crf_38_loss: -7.8749e-02 - crf_39_loss: -9.2570e-02 - crf_37_acc_1: 0.9720 - crf_37_acc_2: 0.7721 - crf_37_acc_3: 0.7754 - crf_38_acc_1: 0.7721 - crf_38_acc_2: 0.9654 - crf_38_acc_3: 0.7734 - crf_39_acc_1: 0.7753 - crf_39_acc_2: 0.7731 - crf_39_acc_3: 0.9844 - val_loss: -2.5144e-01 - val_crf_37_loss: -6.9776e-02 - val_crf_38_loss: -8.4452e-02 - val_crf_39_loss: -9.7214e-02 - val_crf_37_acc_1: 0.9786 - val_crf_37_acc_2: 0.8132 - val_crf_37_acc_3: 0.8135 - val_crf_38_acc_1: 0.8134 - val_crf_38_acc_2: 0.9641 - val_crf_38_acc_3: 0.8151 - val_crf_39_acc_1: 0.8136 - val_crf_39_acc_2: 0.8151 - val_crf_39_acc_3: 0.9858 - val_f1: 0.8679 - val_crf_37_f1: 0.8885 - val_crf_38_f1: 0.8080 - val_crf_39_f1: 0.9071

-------------------------------------------
Best F1 score: 0.879556997511   (epoch number 6)
For task 1
====================================================================================
With padding into account
                           precision    recall  f1-score   support

             abbreviation     0.9111    0.5541    0.6891       148
        archivalreference     0.8155    0.8652    0.8396       853
              archive_lib     0.8776    0.8350    0.8557       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9152    0.9570    0.9356      4948
                      box     0.8305    0.4455    0.5799       110
              cartulation     0.6667    1.0000    0.8000         8
              conjunction     0.5330    0.8433    0.6532       134
                     date     0.4933    0.6379    0.5564        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.4286    0.6429    0.5143        28
                foliation     0.6000    1.0000    0.7500        12
                     null     1.0000    1.0000    1.0000    133958
             numbered_ref     0.3492    0.1833    0.2404       120
                        o     0.3399    0.2979    0.3175       752
               pagination     0.8726    0.9684    0.9180      1139
   publicationnumber-year     0.6299    0.8406    0.7202       646
         publicationplace     0.9377    0.9171    0.9273      1592
publicationspecifications     0.3495    0.4651    0.3991       372
                publisher     0.9405    0.8552    0.8958      1443
                      ref     0.0000    0.0000    0.0000         3
                 registry     0.7273    0.1039    0.1818       154
                   series     0.9111    0.5359    0.6749       153
                    title     0.9473    0.9392    0.9432     15560
                     tomo     0.7816    0.3036    0.4373       224
                   volume     0.5097    0.5704    0.5383       277
                     year     0.9175    0.8089    0.8598      2036

              avg / total     0.9797    0.9779    0.9780    164834


----------------------------------------------

Without the padding:
                           precision    recall  f1-score   support

             abbreviation     0.9111    0.5541    0.6891       148
        archivalreference     0.8155    0.8652    0.8396       853
              archive_lib     0.8776    0.8350    0.8557       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9152    0.9570    0.9356      4948
                      box     0.8305    0.4455    0.5799       110
              cartulation     0.6667    1.0000    0.8000         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5330    0.8433    0.6532       134
                     date     0.4933    0.6379    0.5564        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.4286    0.6429    0.5143        28
                foliation     0.6000    1.0000    0.7500        12
             numbered_ref     0.3492    0.1833    0.2404       120
                        o     0.3399    0.2979    0.3175       752
               pagination     0.8726    0.9684    0.9180      1139
   publicationnumber-year     0.6299    0.8406    0.7202       646
         publicationplace     0.9377    0.9171    0.9273      1592
publicationspecifications     0.3495    0.4651    0.3991       372
                publisher     0.9405    0.8552    0.8958      1443
                      ref     0.0000    0.0000    0.0000         3
                 registry     0.7273    0.1039    0.1818       154
                   series     0.9111    0.5359    0.6749       153
                    title     0.9473    0.9392    0.9432     15560
                     tomo     0.7816    0.3036    0.4373       224
                   volume     0.5097    0.5704    0.5383       277
                     year     0.9175    0.8089    0.8598      2036

              avg / total     0.8914    0.8818    0.8827     30876



For task 2
====================================================================================
With padding into account
                   precision    recall  f1-score   support

b-meta-annotation     0.7267    0.6264    0.6728       348
        b-primary     0.7736    0.3905    0.5190       105
      b-secondary     0.7532    0.6913    0.7209       852
e-meta-annotation     0.8858    0.7747    0.8265      1061
        e-primary     0.7385    0.6400    0.6857       300
      e-secondary     0.8123    0.8695    0.8399      1717
i-meta-annotation     0.8230    0.7899    0.8061      9981
        i-primary     0.8642    0.8287    0.8461      1728
      i-secondary     0.8453    0.8817    0.8631     14357
             null     1.0000    1.0000    1.0000    133958
                o     0.3181    0.3747    0.3441       427

      avg / total     0.9675    0.9673    0.9672    164834


----------------------------------------------

Without the padding:
                   precision    recall  f1-score   support

b-meta-annotation     0.7267    0.6264    0.6728       348
        b-primary     0.7736    0.3905    0.5190       105
      b-secondary     0.7532    0.6913    0.7209       852
e-meta-annotation     0.8858    0.7747    0.8265      1061
        e-primary     0.7385    0.6400    0.6857       300
      e-secondary     0.8123    0.8695    0.8399      1717
i-meta-annotation     0.8230    0.7899    0.8061      9981
        i-primary     0.8642    0.8287    0.8461      1728
      i-secondary     0.8453    0.8817    0.8631     14357
                o     0.3181    0.3747    0.3441       427

      avg / total     0.8262    0.8255    0.8250     30876



For task 3
====================================================================================
With padding into account
             precision    recall  f1-score   support

        b-r     0.8454    0.7249    0.7805      1305
        e-r     0.9454    0.2908    0.4448      1310
        i-r     0.9513    0.9890    0.9698     27834
       null     1.0000    1.0000    1.0000    133958
          o     0.3541    0.3466    0.3503       427

avg / total     0.9885    0.9886    0.9871    164834


----------------------------------------------

Without the padding:
             precision    recall  f1-score   support

        b-r     0.8454    0.7249    0.7805      1305
        e-r     0.9454    0.2908    0.4448      1310
        i-r     0.9513    0.9890    0.9698     27834
          o     0.3541    0.3466    0.3503       427

avg / total     0.9384    0.9393    0.9310     30876




Confusion matrix, without normalization
[[    36      0    112      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    30      2    818      3      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    17      0     86      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   902      0   4028     18      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    110      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      8      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    131      3      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0     58      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      1     26      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0     12      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0 133958      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      2    110      6      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     9      2    579    162      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0    131   1004      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      2    638      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      1   1586      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    355     17      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0   1443      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      0    152      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    153      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   107      2  15406     45      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    224      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    277      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    10    260   1614    152      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]]
Normalized confusion matrix
[[  2.43243243e-01   0.00000000e+00   7.56756757e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.51699883e-02   2.34466589e-03   9.58968347e-01   3.51699883e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.65048544e-01   0.00000000e+00   8.34951456e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [             nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan]
 [  1.82295877e-01   0.00000000e+00   8.14066289e-01   3.63783347e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.77611940e-01   2.23880597e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.57142857e-02   3.57142857e-02   9.28571429e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    1.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.66666667e-02   1.66666667e-02   9.16666667e-01   5.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.19680851e-02   2.65957447e-03   7.69946809e-01   2.15425532e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.15013169e-01   8.81474978e-01   3.51185250e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.09597523e-03   3.09597523e-03   9.87616099e-01   6.19195046e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.28140704e-04   6.28140704e-04   9.96231156e-01   2.51256281e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.54301075e-01   4.56989247e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.29870130e-02   0.00000000e+00   9.87012987e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.87660668e-03   1.28534704e-04   9.90102828e-01   2.89203085e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  4.91159136e-03   1.27701375e-01   7.92730845e-01   7.46561886e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   269      0     39     40      0      0      0      0      0      0
       0]
 [    44      0     61      0      0      0      0      0      0      0
       0]
 [   633      0    116    103      0      0      0      0      0      0
       0]
 [     0    134    919      8      0      0      0      0      0      0
       0]
 [     0      1    296      3      0      0      0      0      0      0
       0]
 [     0    246   1464      7      0      0      0      0      0      0
       0]
 [    50      6   9871     54      0      0      0      0      0      0
       0]
 [     7      6   1706      9      0      0      0      0      0      0
       0]
 [   110      7  14194     46      0      0      0      0      0      0
       0]
 [     0      0      0      0      0      0      0      0      0 133958
       0]
 [     6      3    270    148      0      0      0      0      0      0
       0]]
Normalized confusion matrix
[[  7.72988506e-01   0.00000000e+00   1.12068966e-01   1.14942529e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  4.19047619e-01   0.00000000e+00   5.80952381e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.42957746e-01   0.00000000e+00   1.36150235e-01   1.20892019e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.26295947e-01   8.66163996e-01   7.54005655e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   3.33333333e-03   9.86666667e-01   1.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.43273151e-01   8.52649971e-01   4.07687828e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.00951808e-03   6.01142170e-04   9.88979060e-01   5.41027953e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  4.05092593e-03   3.47222222e-03   9.87268519e-01   5.20833333e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.66176778e-03   4.87567040e-04   9.88646653e-01   3.20401198e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   1.00000000e+00   0.00000000e+00]
 [  1.40515222e-02   7.02576112e-03   6.32318501e-01   3.46604215e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   946      0    216      0    143]
 [     0    381    922      0      7]
 [   167     19  27528      0    120]
 [     0      0      0 133958      0]
 [     6      3    270      0    148]]
Normalized confusion matrix
[[  7.24904215e-01   0.00000000e+00   1.65517241e-01   0.00000000e+00
    1.09578544e-01]
 [  0.00000000e+00   2.90839695e-01   7.03816794e-01   0.00000000e+00
    5.34351145e-03]
 [  5.99985629e-03   6.82618380e-04   9.89006251e-01   0.00000000e+00
    4.31127398e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00
    0.00000000e+00]
 [  1.40515222e-02   7.02576112e-03   6.32318501e-01   0.00000000e+00
    3.46604215e-01]]
