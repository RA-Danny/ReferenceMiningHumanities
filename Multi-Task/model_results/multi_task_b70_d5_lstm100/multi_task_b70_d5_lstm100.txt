______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_28 (InputLayer)                            (None, 73, 54)                   0                                                                   
______________________________________________________________________________________________________________________________________________________
char_embedding (TimeDistributed)                 (None, 73, 54, 100)              16500             input_28[0][0]                                    
______________________________________________________________________________________________________________________________________________________
dropout_40 (Dropout)                             (None, 73, 54, 100)              0                 char_embedding[0][0]                              
______________________________________________________________________________________________________________________________________________________
input_27 (InputLayer)                            (None, 73)                       0                                                                   
______________________________________________________________________________________________________________________________________________________
time_distributed_27 (TimeDistributed)            (None, 73, 54, 50)               25200             dropout_40[0][0]                                  
______________________________________________________________________________________________________________________________________________________
embedding_27 (Embedding)                         (None, 73, 300)                  17130300          input_27[0][0]                                    
______________________________________________________________________________________________________________________________________________________
time_distributed_28 (TimeDistributed)            (None, 73, 2700)                 0                 time_distributed_27[0][0]                         
______________________________________________________________________________________________________________________________________________________
concatenate_14 (Concatenate)                     (None, 73, 3000)                 0                 embedding_27[0][0]                                
                                                                                                    time_distributed_28[0][0]                         
______________________________________________________________________________________________________________________________________________________
dropout_41 (Dropout)                             (None, 73, 3000)                 0                 concatenate_14[0][0]                              
______________________________________________________________________________________________________________________________________________________
bidirectional_28 (Bidirectional)                 (None, 73, 200)                  2480800           dropout_41[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dropout_42 (Dropout)                             (None, 73, 200)                  0                 bidirectional_28[0][0]                            
______________________________________________________________________________________________________________________________________________________
dense_40 (Dense)                                 (None, 73, 28)                   5628              dropout_42[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_41 (Dense)                                 (None, 73, 11)                   2211              dropout_42[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_42 (Dense)                                 (None, 73, 5)                    1005              dropout_42[0][0]                                  
______________________________________________________________________________________________________________________________________________________
crf_40 (CRF)                                     (None, 73, 28)                   1652              dense_40[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_41 (CRF)                                     (None, 73, 11)                   275               dense_41[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_42 (CRF)                                     (None, 73, 5)                    65                dense_42[0][0]                                    
======================================================================================================================================================
Total params: 19,663,636
Trainable params: 19,663,636
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
None 




Train on 49616 samples, validate on 2258 samples
Epoch 1/25
 - 1651s - loss: 0.5479 - crf_40_loss: 0.2490 - crf_41_loss: 0.2055 - crf_42_loss: 0.0934 - crf_40_acc_1: 0.9205 - crf_40_acc_2: 0.7717 - crf_40_acc_3: 0.7751 - crf_41_acc_1: 0.7708 - crf_41_acc_2: 0.9149 - crf_41_acc_3: 0.7738 - crf_42_acc_1: 0.7726 - crf_42_acc_2: 0.7714 - crf_42_acc_3: 0.9636 - val_loss: 0.1812 - val_crf_40_loss: 0.0867 - val_crf_41_loss: 0.0707 - val_crf_42_loss: 0.0238 - val_crf_40_acc_1: 0.9622 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9502 - val_crf_41_acc_3: 0.8154 - val_crf_42_acc_1: 0.8131 - val_crf_42_acc_2: 0.8151 - val_crf_42_acc_3: 0.9873 - val_f1: 0.8192 - val_crf_40_f1: 0.7838 - val_crf_41_f1: 0.7374 - val_crf_42_f1: 0.9363
Epoch 2/25
 - 1619s - loss: 0.1785 - crf_40_loss: 0.0932 - crf_41_loss: 0.0623 - crf_42_loss: 0.0229 - crf_40_acc_1: 0.9534 - crf_40_acc_2: 0.7723 - crf_40_acc_3: 0.7757 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9458 - crf_41_acc_3: 0.7739 - crf_42_acc_1: 0.7749 - crf_42_acc_2: 0.7730 - crf_42_acc_3: 0.9805 - val_loss: 0.0627 - val_crf_40_loss: 0.0389 - val_crf_41_loss: 0.0194 - val_crf_42_loss: 0.0044 - val_crf_40_acc_1: 0.9738 - val_crf_40_acc_2: 0.8129 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8135 - val_crf_41_acc_2: 0.9616 - val_crf_41_acc_3: 0.8153 - val_crf_42_acc_1: 0.8134 - val_crf_42_acc_2: 0.8148 - val_crf_42_acc_3: 0.9909 - val_f1: 0.8653 - val_crf_40_f1: 0.8521 - val_crf_41_f1: 0.7931 - val_crf_42_f1: 0.9507
Epoch 3/25
 - 1610s - loss: 0.0784 - crf_40_loss: 0.0524 - crf_41_loss: 0.0221 - crf_42_loss: 0.0039 - crf_40_acc_1: 0.9592 - crf_40_acc_2: 0.7723 - crf_40_acc_3: 0.7756 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9506 - crf_41_acc_3: 0.7737 - crf_42_acc_1: 0.7751 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9824 - val_loss: 0.0105 - val_crf_40_loss: 0.0184 - val_crf_41_loss: -1.4039e-03 - val_crf_42_loss: -6.5473e-03 - val_crf_40_acc_1: 0.9754 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9628 - val_crf_41_acc_3: 0.8152 - val_crf_42_acc_1: 0.8136 - val_crf_42_acc_2: 0.8152 - val_crf_42_acc_3: 0.9902 - val_f1: 0.8716 - val_crf_40_f1: 0.8673 - val_crf_41_f1: 0.8020 - val_crf_42_f1: 0.9453
Epoch 4/25
 - 1617s - loss: 0.0204 - crf_40_loss: 0.0293 - crf_41_loss: 5.2892e-04 - crf_42_loss: -9.4742e-03 - crf_40_acc_1: 0.9617 - crf_40_acc_2: 0.7723 - crf_40_acc_3: 0.7755 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9532 - crf_41_acc_3: 0.7736 - crf_42_acc_1: 0.7752 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9831 - val_loss: -3.0414e-02 - val_crf_40_loss: 0.0019 - val_crf_41_loss: -1.4986e-02 - val_crf_42_loss: -1.7372e-02 - val_crf_40_acc_1: 0.9765 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8135 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9592 - val_crf_41_acc_3: 0.8153 - val_crf_42_acc_1: 0.8134 - val_crf_42_acc_2: 0.8148 - val_crf_42_acc_3: 0.9897 - val_f1: 0.8650 - val_crf_40_f1: 0.8742 - val_crf_41_f1: 0.7777 - val_crf_42_f1: 0.9431
Epoch 5/25
 - 1609s - loss: -2.1992e-02 - crf_40_loss: 0.0133 - crf_41_loss: -1.4346e-02 - crf_42_loss: -2.0902e-02 - crf_40_acc_1: 0.9632 - crf_40_acc_2: 0.7723 - crf_40_acc_3: 0.7755 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9547 - crf_41_acc_3: 0.7736 - crf_42_acc_1: 0.7752 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9830 - val_loss: -6.3273e-02 - val_crf_40_loss: -8.5092e-03 - val_crf_41_loss: -2.7644e-02 - val_crf_42_loss: -2.7120e-02 - val_crf_40_acc_1: 0.9748 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8135 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9639 - val_crf_41_acc_3: 0.8151 - val_crf_42_acc_1: 0.8135 - val_crf_42_acc_2: 0.8151 - val_crf_42_acc_3: 0.9886 - val_f1: 0.8724 - val_crf_40_f1: 0.8716 - val_crf_41_f1: 0.8084 - val_crf_42_f1: 0.9373
Epoch 6/25
 - 1609s - loss: -5.8553e-02 - crf_40_loss: -4.3553e-04 - crf_41_loss: -2.6607e-02 - crf_42_loss: -3.1511e-02 - crf_40_acc_1: 0.9645 - crf_40_acc_2: 0.7722 - crf_40_acc_3: 0.7754 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9559 - crf_41_acc_3: 0.7735 - crf_42_acc_1: 0.7752 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9829 - val_loss: -9.7557e-02 - val_crf_40_loss: -2.0829e-02 - val_crf_41_loss: -3.8940e-02 - val_crf_42_loss: -3.7788e-02 - val_crf_40_acc_1: 0.9768 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8135 - val_crf_41_acc_2: 0.9644 - val_crf_41_acc_3: 0.8151 - val_crf_42_acc_1: 0.8136 - val_crf_42_acc_2: 0.8152 - val_crf_42_acc_3: 0.9866 - val_f1: 0.8693 - val_crf_40_f1: 0.8792 - val_crf_41_f1: 0.8111 - val_crf_42_f1: 0.9175
Epoch 7/25
 - 1616s - loss: -9.2115e-02 - crf_40_loss: -1.2380e-02 - crf_41_loss: -3.7889e-02 - crf_42_loss: -4.1846e-02 - crf_40_acc_1: 0.9656 - crf_40_acc_2: 0.7723 - crf_40_acc_3: 0.7754 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9577 - crf_41_acc_3: 0.7735 - crf_42_acc_1: 0.7753 - crf_42_acc_2: 0.7730 - crf_42_acc_3: 0.9829 - val_loss: -1.2853e-01 - val_crf_40_loss: -3.1687e-02 - val_crf_41_loss: -4.9166e-02 - val_crf_42_loss: -4.7672e-02 - val_crf_40_acc_1: 0.9777 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9639 - val_crf_41_acc_3: 0.8151 - val_crf_42_acc_1: 0.8136 - val_crf_42_acc_2: 0.8151 - val_crf_42_acc_3: 0.9875 - val_f1: 0.8708 - val_crf_40_f1: 0.8827 - val_crf_41_f1: 0.8077 - val_crf_42_f1: 0.9220
Epoch 8/25
 - 1613s - loss: -1.2360e-01 - crf_40_loss: -2.3441e-02 - crf_41_loss: -4.8285e-02 - crf_42_loss: -5.1873e-02 - crf_40_acc_1: 0.9665 - crf_40_acc_2: 0.7722 - crf_40_acc_3: 0.7754 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9580 - crf_41_acc_3: 0.7735 - crf_42_acc_1: 0.7753 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9826 - val_loss: -1.5567e-01 - val_crf_40_loss: -4.0619e-02 - val_crf_41_loss: -5.8045e-02 - val_crf_42_loss: -5.7004e-02 - val_crf_40_acc_1: 0.9773 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8135 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9630 - val_crf_41_acc_3: 0.8152 - val_crf_42_acc_1: 0.8136 - val_crf_42_acc_2: 0.8149 - val_crf_42_acc_3: 0.9849 - val_f1: 0.8621 - val_crf_40_f1: 0.8816 - val_crf_41_f1: 0.8016 - val_crf_42_f1: 0.9032
Epoch 9/25
 - 1611s - loss: -1.5420e-01 - crf_40_loss: -3.4012e-02 - crf_41_loss: -5.8388e-02 - crf_42_loss: -6.1797e-02 - crf_40_acc_1: 0.9670 - crf_40_acc_2: 0.7722 - crf_40_acc_3: 0.7754 - crf_41_acc_1: 0.7721 - crf_41_acc_2: 0.9595 - crf_41_acc_3: 0.7735 - crf_42_acc_1: 0.7753 - crf_42_acc_2: 0.7731 - crf_42_acc_3: 0.9825 - val_loss: -1.8535e-01 - val_crf_40_loss: -5.0527e-02 - val_crf_41_loss: -6.7823e-02 - val_crf_42_loss: -6.6997e-02 - val_crf_40_acc_1: 0.9772 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8135 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9610 - val_crf_41_acc_3: 0.8152 - val_crf_42_acc_1: 0.8135 - val_crf_42_acc_2: 0.8150 - val_crf_42_acc_3: 0.9846 - val_f1: 0.8577 - val_crf_40_f1: 0.8801 - val_crf_41_f1: 0.7913 - val_crf_42_f1: 0.9017
Epoch 10/25
 - 1613s - loss: -1.8448e-01 - crf_40_loss: -4.4293e-02 - crf_41_loss: -6.8469e-02 - crf_42_loss: -7.1715e-02 - crf_40_acc_1: 0.9676 - crf_40_acc_2: 0.7722 - crf_40_acc_3: 0.7754 - crf_41_acc_1: 0.7722 - crf_41_acc_2: 0.9605 - crf_41_acc_3: 0.7735 - crf_42_acc_1: 0.7753 - crf_42_acc_2: 0.7730 - crf_42_acc_3: 0.9827 - val_loss: -2.1850e-01 - val_crf_40_loss: -6.0878e-02 - val_crf_41_loss: -7.9548e-02 - val_crf_42_loss: -7.8070e-02 - val_crf_40_acc_1: 0.9782 - val_crf_40_acc_2: 0.8130 - val_crf_40_acc_3: 0.8134 - val_crf_41_acc_1: 0.8134 - val_crf_41_acc_2: 0.9657 - val_crf_41_acc_3: 0.8152 - val_crf_42_acc_1: 0.8136 - val_crf_42_acc_2: 0.8153 - val_crf_42_acc_3: 0.9859 - val_f1: 0.8701 - val_crf_40_f1: 0.8854 - val_crf_41_f1: 0.8180 - val_crf_42_f1: 0.9070

-------------------------------------------
Best F1 score: 0.872425436295   (epoch number 5)
For task 1
====================================================================================
With padding into account
                           precision    recall  f1-score   support

             abbreviation     0.9149    0.5811    0.7107       148
        archivalreference     0.8551    0.8370    0.8460       853
              archive_lib     0.8611    0.9029    0.8815       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9470    0.9212    0.9339      4948
                      box     0.8542    0.3727    0.5190       110
              cartulation     0.5000    1.0000    0.6667         8
              conjunction     0.5231    0.7612    0.6201       134
                     date     0.3203    0.7069    0.4409        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.3333    0.6429    0.4390        28
                foliation     0.6000    1.0000    0.7500        12
                     null     1.0000    1.0000    1.0000    133958
             numbered_ref     0.1869    0.1667    0.1762       120
                        o     0.2406    0.3231    0.2758       752
               pagination     0.9274    0.9649    0.9458      1139
   publicationnumber-year     0.6141    0.8498    0.7130       646
         publicationplace     0.9461    0.8593    0.9006      1592
publicationspecifications     0.3481    0.3790    0.3629       372
                publisher     0.9109    0.8358    0.8717      1443
                      ref     0.2857    0.6667    0.4000         3
                 registry     0.7273    0.1039    0.1818       154
                   series     0.9560    0.5686    0.7131       153
                    title     0.9277    0.9331    0.9304     15560
                     tomo     0.8395    0.3036    0.4459       224
                   volume     0.4576    0.5451    0.4975       277
                     year     0.9415    0.7750    0.8502      2036

              avg / total     0.9788    0.9748    0.9759    164834


----------------------------------------------

Without the padding:
                           precision    recall  f1-score   support

             abbreviation     0.9149    0.5811    0.7107       148
        archivalreference     0.8551    0.8370    0.8460       853
              archive_lib     0.8611    0.9029    0.8815       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9470    0.9212    0.9339      4948
                      box     0.8542    0.3727    0.5190       110
              cartulation     0.5000    1.0000    0.6667         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5231    0.7612    0.6201       134
                     date     0.3203    0.7069    0.4409        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.3333    0.6429    0.4390        28
                foliation     0.6000    1.0000    0.7500        12
             numbered_ref     0.1869    0.1667    0.1762       120
                        o     0.2406    0.3231    0.2758       752
               pagination     0.9274    0.9649    0.9458      1139
   publicationnumber-year     0.6141    0.8498    0.7130       646
         publicationplace     0.9461    0.8593    0.9006      1592
publicationspecifications     0.3481    0.3790    0.3629       372
                publisher     0.9109    0.8358    0.8717      1443
                      ref     0.2857    0.6667    0.4000         3
                 registry     0.7273    0.1039    0.1818       154
                   series     0.9560    0.5686    0.7131       153
                    title     0.9277    0.9331    0.9304     15560
                     tomo     0.8395    0.3036    0.4459       224
                   volume     0.4576    0.5451    0.4975       277
                     year     0.9415    0.7750    0.8502      2036

              avg / total     0.8867    0.8655    0.8716     30876



For task 2
====================================================================================
With padding into account
                   precision    recall  f1-score   support

b-meta-annotation     0.6862    0.5718    0.6238       348
        b-primary     0.6389    0.2190    0.3262       105
      b-secondary     0.7332    0.6514    0.6899       852
e-meta-annotation     0.8947    0.7606    0.8222      1061
        e-primary     0.6446    0.6167    0.6303       300
      e-secondary     0.8140    0.8561    0.8345      1717
i-meta-annotation     0.8024    0.7887    0.7955      9981
        i-primary     0.7641    0.7928    0.7782      1728
      i-secondary     0.8460    0.8549    0.8504     14357
             null     1.0000    1.0000    1.0000    133958
                o     0.2507    0.4028    0.3091       427

      avg / total     0.9647    0.9639    0.9641    164834


----------------------------------------------

Without the padding:
                   precision    recall  f1-score   support

b-meta-annotation     0.6862    0.5718    0.6238       348
        b-primary     0.6389    0.2190    0.3262       105
      b-secondary     0.7332    0.6514    0.6899       852
e-meta-annotation     0.8947    0.7606    0.8222      1061
        e-primary     0.6446    0.6167    0.6303       300
      e-secondary     0.8140    0.8561    0.8345      1717
i-meta-annotation     0.8024    0.7887    0.7955      9981
        i-primary     0.7641    0.7928    0.7782      1728
      i-secondary     0.8460    0.8549    0.8504     14357
                o     0.2507    0.4028    0.3091       427

      avg / total     0.8114    0.8073    0.8084     30876



For task 3
====================================================================================
With padding into account
             precision    recall  f1-score   support

        b-r     0.8185    0.6774    0.7413      1305
        e-r     0.9395    0.4863    0.6408      1310
        i-r     0.9593    0.9805    0.9698     27834
       null     1.0000    1.0000    1.0000    133958
          o     0.2687    0.4215    0.3282       427

avg / total     0.9893    0.9886    0.9883    164834


----------------------------------------------

Without the padding:
             precision    recall  f1-score   support

        b-r     0.8185    0.6774    0.7413      1305
        e-r     0.9395    0.4863    0.6408      1310
        i-r     0.9593    0.9805    0.9698     27834
          o     0.2687    0.4215    0.3282       427

avg / total     0.9430    0.9390    0.9373     30876




Confusion matrix, without normalization
[[    36      0    112      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    11     12    821      9      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    16      0     80      7      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   891      2   4015     40      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    110      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      2      6      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    130      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      2     56      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      1     26      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      2     10      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0 133958      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      3    109      6      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     7      6    531    208      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0    175    964      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      5    640      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1   1588      3      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      2    344     26      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0   1441      2      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     5      0    149      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    153      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   109      3  15279    169      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    224      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    277      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1    462   1377    196      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]]
Normalized confusion matrix
[[  2.43243243e-01   0.00000000e+00   7.56756757e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.28956624e-02   1.40679953e-02   9.62485346e-01   1.05509965e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.55339806e-01   0.00000000e+00   7.76699029e-01   6.79611650e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [             nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan]
 [  1.80072757e-01   4.04203719e-04   8.11438965e-01   8.08407437e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   2.50000000e-01   7.50000000e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.70149254e-01   2.98507463e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   3.44827586e-02   9.65517241e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.57142857e-02   3.57142857e-02   9.28571429e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.66666667e-01   8.33333333e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    1.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.66666667e-02   2.50000000e-02   9.08333333e-01   5.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  9.30851064e-03   7.97872340e-03   7.06117021e-01   2.76595745e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.53643547e-01   8.46356453e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.54798762e-03   7.73993808e-03   9.90712074e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   6.28140704e-04   9.97487437e-01   1.88442211e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   5.37634409e-03   9.24731183e-01   6.98924731e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.98613999e-01   1.38600139e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.24675325e-02   0.00000000e+00   9.67532468e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.00514139e-03   1.92802057e-04   9.81940874e-01   1.08611825e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  4.91159136e-04   2.26915521e-01   6.76326130e-01   9.62671906e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   261      0     46     41      0      0      0      0      0      0
       0]
 [    25      0     79      1      0      0      0      0      0      0
       0]
 [   598      0    140    114      0      0      0      0      0      0
       0]
 [     0    199    858      4      0      0      0      0      0      0
       0]
 [     1      4    275     20      0      0      0      0      0      0
       0]
 [     0    434   1263     20      0      0      0      0      0      0
       0]
 [    54      8   9817    102      0      0      0      0      0      0
       0]
 [    14     19   1631     64      0      0      0      0      0      0
       0]
 [   122     10  14101    124      0      0      0      0      0      0
       0]
 [     0      0      0      0      0      0      0      0      0 133958
       0]
 [     5      4    238    180      0      0      0      0      0      0
       0]]
Normalized confusion matrix
[[  7.50000000e-01   0.00000000e+00   1.32183908e-01   1.17816092e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  2.38095238e-01   0.00000000e+00   7.52380952e-01   9.52380952e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.01877934e-01   0.00000000e+00   1.64319249e-01   1.33802817e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.87558907e-01   8.08671065e-01   3.77002828e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.33333333e-03   1.33333333e-02   9.16666667e-01   6.66666667e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   2.52766453e-01   7.35585323e-01   1.16482236e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.41027953e-03   8.01522893e-04   9.83568781e-01   1.02194169e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.10185185e-03   1.09953704e-02   9.43865741e-01   3.70370370e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.49759699e-03   6.96524344e-04   9.82168977e-01   8.63690186e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   1.00000000e+00   0.00000000e+00]
 [  1.17096019e-02   9.36768150e-03   5.57377049e-01   4.21545667e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   884      0    265      0    156]
 [     0    637    654      0     19]
 [   191     37  27291      0    315]
 [     0      0      0 133958      0]
 [     5      4    238      0    180]]
Normalized confusion matrix
[[ 0.67739464  0.          0.20306513  0.          0.11954023]
 [ 0.          0.48625954  0.49923664  0.          0.01450382]
 [ 0.00686211  0.00132931  0.98049149  0.          0.01131709]
 [ 0.          0.          0.          1.          0.        ]
 [ 0.0117096   0.00936768  0.55737705  0.          0.42154567]]
