______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_48 (InputLayer)                            (None, 73, 54)                   0                                                                   
______________________________________________________________________________________________________________________________________________________
char_embedding (TimeDistributed)                 (None, 73, 54, 100)              16500             input_48[0][0]                                    
______________________________________________________________________________________________________________________________________________________
dropout_70 (Dropout)                             (None, 73, 54, 100)              0                 char_embedding[0][0]                              
______________________________________________________________________________________________________________________________________________________
input_47 (InputLayer)                            (None, 73)                       0                                                                   
______________________________________________________________________________________________________________________________________________________
time_distributed_47 (TimeDistributed)            (None, 73, 54, 50)               25200             dropout_70[0][0]                                  
______________________________________________________________________________________________________________________________________________________
embedding_47 (Embedding)                         (None, 73, 300)                  17130300          input_47[0][0]                                    
______________________________________________________________________________________________________________________________________________________
time_distributed_48 (TimeDistributed)            (None, 73, 2700)                 0                 time_distributed_47[0][0]                         
______________________________________________________________________________________________________________________________________________________
concatenate_24 (Concatenate)                     (None, 73, 3000)                 0                 embedding_47[0][0]                                
                                                                                                    time_distributed_48[0][0]                         
______________________________________________________________________________________________________________________________________________________
dropout_71 (Dropout)                             (None, 73, 3000)                 0                 concatenate_24[0][0]                              
______________________________________________________________________________________________________________________________________________________
bidirectional_48 (Bidirectional)                 (None, 73, 80)                   973120            dropout_71[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dropout_72 (Dropout)                             (None, 73, 80)                   0                 bidirectional_48[0][0]                            
______________________________________________________________________________________________________________________________________________________
dense_70 (Dense)                                 (None, 73, 28)                   2268              dropout_72[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_71 (Dense)                                 (None, 73, 11)                   891               dropout_72[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_72 (Dense)                                 (None, 73, 5)                    405               dropout_72[0][0]                                  
______________________________________________________________________________________________________________________________________________________
crf_70 (CRF)                                     (None, 73, 28)                   1652              dense_70[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_71 (CRF)                                     (None, 73, 11)                   275               dense_71[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_72 (CRF)                                     (None, 73, 5)                    65                dense_72[0][0]                                    
======================================================================================================================================================
Total params: 18,150,676
Trainable params: 18,150,676
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
None 




Train on 49616 samples, validate on 2258 samples
Epoch 1/25
 - 2661s - loss: 0.3935 - crf_70_loss: 0.1994 - crf_71_loss: 0.1421 - crf_72_loss: 0.0520 - crf_70_acc_1: 0.9247 - crf_70_acc_2: 0.7719 - crf_70_acc_3: 0.7754 - crf_71_acc_1: 0.7714 - crf_71_acc_2: 0.9186 - crf_71_acc_3: 0.7739 - crf_72_acc_1: 0.7730 - crf_72_acc_2: 0.7719 - crf_72_acc_3: 0.9677 - val_loss: 0.0753 - val_crf_70_loss: 0.0525 - val_crf_71_loss: 0.0220 - val_crf_72_loss: 8.2239e-04 - val_crf_70_acc_1: 0.9618 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8135 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9478 - val_crf_71_acc_3: 0.8155 - val_crf_72_acc_1: 0.8131 - val_crf_72_acc_2: 0.8151 - val_crf_72_acc_3: 0.9886 - val_f1: 0.8094 - val_crf_70_f1: 0.7735 - val_crf_71_f1: 0.7208 - val_crf_72_f1: 0.9341
Epoch 2/25
 - 2552s - loss: 0.0597 - crf_70_loss: 0.0554 - crf_71_loss: 0.0109 - crf_72_loss: -6.6543e-03 - crf_70_acc_1: 0.9498 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7757 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9405 - crf_71_acc_3: 0.7739 - crf_72_acc_1: 0.7749 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9775 - val_loss: -3.2401e-02 - val_crf_70_loss: 0.0084 - val_crf_71_loss: -1.6103e-02 - val_crf_72_loss: -2.4691e-02 - val_crf_70_acc_1: 0.9687 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9578 - val_crf_71_acc_3: 0.8156 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8146 - val_crf_72_acc_3: 0.9853 - val_f1: 0.8408 - val_crf_70_f1: 0.8326 - val_crf_71_f1: 0.7762 - val_crf_72_f1: 0.9136
Epoch 3/25
 - 2598s - loss: -3.8915e-02 - crf_70_loss: 0.0160 - crf_71_loss: -2.2556e-02 - crf_72_loss: -3.2401e-02 - crf_70_acc_1: 0.9546 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7756 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9434 - crf_71_acc_3: 0.7738 - crf_72_acc_1: 0.7752 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9775 - val_loss: -1.1055e-01 - val_crf_70_loss: -2.0001e-02 - val_crf_71_loss: -4.1979e-02 - val_crf_72_loss: -4.8566e-02 - val_crf_70_acc_1: 0.9723 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9563 - val_crf_71_acc_3: 0.8153 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8145 - val_crf_72_acc_3: 0.9851 - val_f1: 0.8368 - val_crf_70_f1: 0.8515 - val_crf_71_f1: 0.7585 - val_crf_72_f1: 0.9003
Epoch 4/25
 - 2528s - loss: -1.1355e-01 - crf_70_loss: -1.0421e-02 - crf_71_loss: -4.7380e-02 - crf_72_loss: -5.5751e-02 - crf_70_acc_1: 0.9563 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9460 - crf_71_acc_3: 0.7737 - crf_72_acc_1: 0.7753 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9776 - val_loss: -1.7839e-01 - val_crf_70_loss: -4.2777e-02 - val_crf_71_loss: -6.4923e-02 - val_crf_72_loss: -7.0693e-02 - val_crf_70_acc_1: 0.9734 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9609 - val_crf_71_acc_3: 0.8153 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8147 - val_crf_72_acc_3: 0.9844 - val_f1: 0.8496 - val_crf_70_f1: 0.8592 - val_crf_71_f1: 0.7905 - val_crf_72_f1: 0.8990
Epoch 5/25
 - 2594s - loss: -1.8223e-01 - crf_70_loss: -3.3792e-02 - crf_71_loss: -7.0044e-02 - crf_72_loss: -7.8396e-02 - crf_70_acc_1: 0.9573 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7723 - crf_71_acc_2: 0.9478 - crf_71_acc_3: 0.7737 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9780 - val_loss: -2.4456e-01 - val_crf_70_loss: -6.4643e-02 - val_crf_71_loss: -8.6407e-02 - val_crf_72_loss: -9.3507e-02 - val_crf_70_acc_1: 0.9745 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9536 - val_crf_71_acc_3: 0.8154 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8145 - val_crf_72_acc_3: 0.9851 - val_f1: 0.8359 - val_crf_70_f1: 0.8645 - val_crf_71_f1: 0.7415 - val_crf_72_f1: 0.9017
Epoch 6/25
 - 2596s - loss: -2.4895e-01 - crf_70_loss: -5.5661e-02 - crf_71_loss: -9.2281e-02 - crf_72_loss: -1.0101e-01 - crf_70_acc_1: 0.9582 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9496 - crf_71_acc_3: 0.7737 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9787 - val_loss: -3.1174e-01 - val_crf_70_loss: -8.5370e-02 - val_crf_71_loss: -1.0986e-01 - val_crf_72_loss: -1.1650e-01 - val_crf_70_acc_1: 0.9743 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9625 - val_crf_71_acc_3: 0.8152 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8152 - val_crf_72_acc_3: 0.9851 - val_f1: 0.8563 - val_crf_70_f1: 0.8654 - val_crf_71_f1: 0.8013 - val_crf_72_f1: 0.9022
Epoch 7/25
 - 2538s - loss: -3.1440e-01 - crf_70_loss: -7.6783e-02 - crf_71_loss: -1.1417e-01 - crf_72_loss: -1.2345e-01 - crf_70_acc_1: 0.9590 - crf_70_acc_2: 0.7724 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7723 - crf_71_acc_2: 0.9504 - crf_71_acc_3: 0.7736 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9789 - val_loss: -3.7239e-01 - val_crf_70_loss: -1.0524e-01 - val_crf_71_loss: -1.2970e-01 - val_crf_72_loss: -1.3745e-01 - val_crf_70_acc_1: 0.9752 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9600 - val_crf_71_acc_3: 0.8154 - val_crf_72_acc_1: 0.8136 - val_crf_72_acc_2: 0.8147 - val_crf_72_acc_3: 0.9854 - val_f1: 0.8500 - val_crf_70_f1: 0.8665 - val_crf_71_f1: 0.7815 - val_crf_72_f1: 0.9020
Epoch 8/25
 - 2521s - loss: -3.7921e-01 - crf_70_loss: -9.7530e-02 - crf_71_loss: -1.3588e-01 - crf_72_loss: -1.4580e-01 - crf_70_acc_1: 0.9593 - crf_70_acc_2: 0.7723 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9520 - crf_71_acc_3: 0.7736 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9794 - val_loss: -4.3909e-01 - val_crf_70_loss: -1.2552e-01 - val_crf_71_loss: -1.5272e-01 - val_crf_72_loss: -1.6085e-01 - val_crf_70_acc_1: 0.9756 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9620 - val_crf_71_acc_3: 0.8153 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8150 - val_crf_72_acc_3: 0.9855 - val_f1: 0.8550 - val_crf_70_f1: 0.8668 - val_crf_71_f1: 0.7956 - val_crf_72_f1: 0.9025
Epoch 9/25
 - 2596s - loss: -4.4387e-01 - crf_70_loss: -1.1819e-01 - crf_71_loss: -1.5754e-01 - crf_72_loss: -1.6814e-01 - crf_70_acc_1: 0.9602 - crf_70_acc_2: 0.7723 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9529 - crf_71_acc_3: 0.7736 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9797 - val_loss: -5.0149e-01 - val_crf_70_loss: -1.4606e-01 - val_crf_71_loss: -1.7328e-01 - val_crf_72_loss: -1.8215e-01 - val_crf_70_acc_1: 0.9754 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9597 - val_crf_71_acc_3: 0.8154 - val_crf_72_acc_1: 0.8134 - val_crf_72_acc_2: 0.8150 - val_crf_72_acc_3: 0.9846 - val_f1: 0.8508 - val_crf_70_f1: 0.8692 - val_crf_71_f1: 0.7824 - val_crf_72_f1: 0.9009
Epoch 10/25
 - 2536s - loss: -5.0797e-01 - crf_70_loss: -1.3844e-01 - crf_71_loss: -1.7915e-01 - crf_72_loss: -1.9038e-01 - crf_70_acc_1: 0.9606 - crf_70_acc_2: 0.7723 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9535 - crf_71_acc_3: 0.7736 - crf_72_acc_1: 0.7754 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9801 - val_loss: -5.6628e-01 - val_crf_70_loss: -1.6542e-01 - val_crf_71_loss: -1.9562e-01 - val_crf_72_loss: -2.0524e-01 - val_crf_70_acc_1: 0.9738 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9598 - val_crf_71_acc_3: 0.8152 - val_crf_72_acc_1: 0.8135 - val_crf_72_acc_2: 0.8150 - val_crf_72_acc_3: 0.9849 - val_f1: 0.8510 - val_crf_70_f1: 0.8657 - val_crf_71_f1: 0.7850 - val_crf_72_f1: 0.9022
Epoch 11/25
 - 2562s - loss: -5.7176e-01 - crf_70_loss: -1.5859e-01 - crf_71_loss: -2.0062e-01 - crf_72_loss: -2.1254e-01 - crf_70_acc_1: 0.9608 - crf_70_acc_2: 0.7723 - crf_70_acc_3: 0.7755 - crf_71_acc_1: 0.7722 - crf_71_acc_2: 0.9540 - crf_71_acc_3: 0.7736 - crf_72_acc_1: 0.7753 - crf_72_acc_2: 0.7730 - crf_72_acc_3: 0.9803 - val_loss: -6.3103e-01 - val_crf_70_loss: -1.8647e-01 - val_crf_71_loss: -2.1709e-01 - val_crf_72_loss: -2.2747e-01 - val_crf_70_acc_1: 0.9755 - val_crf_70_acc_2: 0.8130 - val_crf_70_acc_3: 0.8134 - val_crf_71_acc_1: 0.8134 - val_crf_71_acc_2: 0.9610 - val_crf_71_acc_3: 0.8153 - val_crf_72_acc_1: 0.8136 - val_crf_72_acc_2: 0.8151 - val_crf_72_acc_3: 0.9851 - val_f1: 0.8555 - val_crf_70_f1: 0.8721 - val_crf_71_f1: 0.7912 - val_crf_72_f1: 0.9032

-------------------------------------------
Best F1 score: 0.856272322503   (epoch number 6)
For task 1
====================================================================================
With padding into account
                           precision    recall  f1-score   support

             abbreviation     0.9762    0.5541    0.7069       148
        archivalreference     0.7516    0.6776    0.7127       853
              archive_lib     0.7453    0.7670    0.7560       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9182    0.9390    0.9285      4948
                      box     0.8113    0.3909    0.5276       110
              cartulation     0.3333    1.0000    0.5000         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5231    0.7612    0.6201       134
                     date     0.3375    0.4655    0.3913        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.3256    0.5000    0.3944        28
                foliation     0.6000    1.0000    0.7500        12
                     null     1.0000    1.0000    1.0000    133958
             numbered_ref     0.0966    0.1667    0.1223       120
                        o     0.2447    0.3059    0.2719       752
               pagination     0.9006    0.9543    0.9267      1139
   publicationnumber-year     0.6474    0.7786    0.7070       646
         publicationplace     0.9213    0.8901    0.9054      1592
publicationspecifications     0.3279    0.2688    0.2954       372
                publisher     0.8980    0.8233    0.8590      1443
                      ref     0.0000    0.0000    0.0000         3
                 registry     0.8889    0.1039    0.1860       154
                   series     0.7078    0.7124    0.7101       153
                    title     0.9300    0.9378    0.9339     15560
                     tomo     0.7629    0.3304    0.4611       224
                   volume     0.5053    0.5199    0.5125       277
                     year     0.9202    0.7706    0.8388      2036

              avg / total     0.9767    0.9743    0.9748    164834


----------------------------------------------

Without the padding:
                           precision    recall  f1-score   support

             abbreviation     0.9762    0.5541    0.7069       148
        archivalreference     0.7516    0.6776    0.7127       853
              archive_lib     0.7453    0.7670    0.7560       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9182    0.9390    0.9285      4948
                      box     0.8113    0.3909    0.5276       110
              cartulation     0.3333    1.0000    0.5000         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5231    0.7612    0.6201       134
                     date     0.3375    0.4655    0.3913        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.3256    0.5000    0.3944        28
                foliation     0.6000    1.0000    0.7500        12
             numbered_ref     0.0966    0.1667    0.1223       120
                        o     0.2447    0.3059    0.2719       752
               pagination     0.9006    0.9543    0.9267      1139
   publicationnumber-year     0.6474    0.7786    0.7070       646
         publicationplace     0.9213    0.8901    0.9054      1592
publicationspecifications     0.3279    0.2688    0.2954       372
                publisher     0.8980    0.8233    0.8590      1443
                      ref     0.0000    0.0000    0.0000         3
                 registry     0.8889    0.1039    0.1860       154
                   series     0.7078    0.7124    0.7101       153
                    title     0.9300    0.9378    0.9339     15560
                     tomo     0.7629    0.3304    0.4611       224
                   volume     0.5053    0.5199    0.5125       277
                     year     0.9202    0.7706    0.8388      2036

              avg / total     0.8755    0.8629    0.8654     30876



For task 2
====================================================================================
With padding into account
                   precision    recall  f1-score   support

b-meta-annotation     0.6352    0.5805    0.6066       348
        b-primary     0.6053    0.2190    0.3217       105
      b-secondary     0.7493    0.6279    0.6833       852
e-meta-annotation     0.8770    0.7795    0.8253      1061
        e-primary     0.7413    0.7067    0.7235       300
      e-secondary     0.8607    0.8276    0.8438      1717
i-meta-annotation     0.7504    0.8236    0.7853      9981
        i-primary     0.7819    0.8900    0.8325      1728
      i-secondary     0.8634    0.8062    0.8338     14357
             null     1.0000    1.0000    1.0000    133958
                o     0.2483    0.3489    0.2902       427

      avg / total     0.9637    0.9625    0.9628    164834


----------------------------------------------

Without the padding:
                   precision    recall  f1-score   support

b-meta-annotation     0.6352    0.5805    0.6066       348
        b-primary     0.6053    0.2190    0.3217       105
      b-secondary     0.7493    0.6279    0.6833       852
e-meta-annotation     0.8770    0.7795    0.8253      1061
        e-primary     0.7413    0.7067    0.7235       300
      e-secondary     0.8607    0.8276    0.8438      1717
i-meta-annotation     0.7504    0.8236    0.7853      9981
        i-primary     0.7819    0.8900    0.8325      1728
      i-secondary     0.8634    0.8062    0.8338     14357
                o     0.2483    0.3489    0.2902       427

      avg / total     0.8063    0.8000    0.8013     30876



For task 3
====================================================================================
With padding into account
             precision    recall  f1-score   support

        b-r     0.8215    0.6805    0.7443      1305
        e-r     0.3421    0.0099    0.0193      1310
        i-r     0.9383    0.9826    0.9600     27834
       null     1.0000    1.0000    1.0000    133958
          o     0.2782    0.3981    0.3276       427

avg / total     0.9811    0.9851    0.9817    164834


----------------------------------------------

Without the padding:
             precision    recall  f1-score   support

        b-r     0.8215    0.6805    0.7443      1305
        e-r     0.3421    0.0099    0.0193      1310
        i-r     0.9383    0.9826    0.9600     27834
          o     0.2782    0.3981    0.3276       427

avg / total     0.8990    0.9205    0.9022     30876




Confusion matrix, without normalization
[[    38      0    110      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    12      4    824     13      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    17      0     79      7      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   875      4   4047     22      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    110      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      8      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    127      7      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0     53      5      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      2     25      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1     11      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0 133958      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      2    110      6      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    10      0    570    172      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      5   1133      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      1    641      3      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0   1588      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    341     31      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      0   1435      7      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     5      0    149      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    153      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   111      1  15285    163      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    224      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    277      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     7     18   1840    171      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]]
Normalized confusion matrix
[[  2.56756757e-01   0.00000000e+00   7.43243243e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.40679953e-02   4.68933177e-03   9.66002345e-01   1.52403283e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.65048544e-01   0.00000000e+00   7.66990291e-01   6.79611650e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [             nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan]
 [  1.76839127e-01   8.08407437e-04   8.17906225e-01   4.44624091e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.47761194e-01   5.22388060e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.13793103e-01   8.62068966e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.57142857e-02   7.14285714e-02   8.92857143e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   8.33333333e-02   9.16666667e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    1.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.66666667e-02   1.66666667e-02   9.16666667e-01   5.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.32978723e-02   0.00000000e+00   7.57978723e-01   2.28723404e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.77963126e-04   4.38981563e-03   9.94732221e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.54798762e-03   1.54798762e-03   9.92260062e-01   4.64396285e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.97487437e-01   2.51256281e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.16666667e-01   8.33333333e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.93000693e-04   0.00000000e+00   9.94455994e-01   4.85100485e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.24675325e-02   0.00000000e+00   9.67532468e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.13367609e-03   6.42673522e-05   9.82326478e-01   1.04755784e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.43811395e-03   8.84086444e-03   9.03732809e-01   8.39882122e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   264      0     43     41      0      0      0      0      0      0
       0]
 [    26      0     78      1      0      0      0      0      0      0
       0]
 [   598      0    150    104      0      0      0      0      0      0
       0]
 [     0      3   1058      0      0      0      0      0      0      0
       0]
 [     0      0    286     14      0      0      0      0      0      0
       0]
 [     0     10   1679     28      0      0      0      0      0      0
       0]
 [    61      5   9825     90      0      0      0      0      0      0
       0]
 [     9      9   1665     45      0      0      0      0      0      0
       0]
 [   115     11  14113    118      0      0      0      0      0      0
       0]
 [     0      0      0      0      0      0      0      0      0 133958
       0]
 [     8      0    249    170      0      0      0      0      0      0
       0]]
Normalized confusion matrix
[[  7.58620690e-01   0.00000000e+00   1.23563218e-01   1.17816092e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  2.47619048e-01   0.00000000e+00   7.42857143e-01   9.52380952e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.01877934e-01   0.00000000e+00   1.76056338e-01   1.22065728e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   2.82752121e-03   9.97172479e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.53333333e-01   4.66666667e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   5.82411182e-03   9.77868375e-01   1.63075131e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.11161206e-03   5.00951808e-04   9.84370304e-01   9.01713255e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.20833333e-03   5.20833333e-03   9.63541667e-01   2.60416667e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.01002995e-03   7.66176778e-04   9.83004806e-01   8.21898725e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   1.00000000e+00   0.00000000e+00]
 [  1.87353630e-02   0.00000000e+00   5.83138173e-01   3.98126464e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   888      0    271      0    146]
 [     0     13   1277      0     20]
 [   185     25  27349      0    275]
 [     0      0      0 133958      0]
 [     8      0    249      0    170]]
Normalized confusion matrix
[[  6.80459770e-01   0.00000000e+00   2.07662835e-01   0.00000000e+00
    1.11877395e-01]
 [  0.00000000e+00   9.92366412e-03   9.74809160e-01   0.00000000e+00
    1.52671756e-02]
 [  6.64654739e-03   8.98182079e-04   9.82575268e-01   0.00000000e+00
    9.88000287e-03]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e+00
    0.00000000e+00]
 [  1.87353630e-02   0.00000000e+00   5.83138173e-01   0.00000000e+00
    3.98126464e-01]]
