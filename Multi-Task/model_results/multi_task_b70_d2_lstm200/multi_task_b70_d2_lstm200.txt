______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_32 (InputLayer)                            (None, 73, 54)                   0                                                                   
______________________________________________________________________________________________________________________________________________________
char_embedding (TimeDistributed)                 (None, 73, 54, 100)              16500             input_32[0][0]                                    
______________________________________________________________________________________________________________________________________________________
dropout_46 (Dropout)                             (None, 73, 54, 100)              0                 char_embedding[0][0]                              
______________________________________________________________________________________________________________________________________________________
input_31 (InputLayer)                            (None, 73)                       0                                                                   
______________________________________________________________________________________________________________________________________________________
time_distributed_31 (TimeDistributed)            (None, 73, 54, 50)               25200             dropout_46[0][0]                                  
______________________________________________________________________________________________________________________________________________________
embedding_31 (Embedding)                         (None, 73, 300)                  17130300          input_31[0][0]                                    
______________________________________________________________________________________________________________________________________________________
time_distributed_32 (TimeDistributed)            (None, 73, 2700)                 0                 time_distributed_31[0][0]                         
______________________________________________________________________________________________________________________________________________________
concatenate_16 (Concatenate)                     (None, 73, 3000)                 0                 embedding_31[0][0]                                
                                                                                                    time_distributed_32[0][0]                         
______________________________________________________________________________________________________________________________________________________
dropout_47 (Dropout)                             (None, 73, 3000)                 0                 concatenate_16[0][0]                              
______________________________________________________________________________________________________________________________________________________
bidirectional_32 (Bidirectional)                 (None, 73, 400)                  5121600           dropout_47[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dropout_48 (Dropout)                             (None, 73, 400)                  0                 bidirectional_32[0][0]                            
______________________________________________________________________________________________________________________________________________________
dense_46 (Dense)                                 (None, 73, 28)                   11228             dropout_48[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_47 (Dense)                                 (None, 73, 11)                   4411              dropout_48[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_48 (Dense)                                 (None, 73, 5)                    2005              dropout_48[0][0]                                  
______________________________________________________________________________________________________________________________________________________
crf_46 (CRF)                                     (None, 73, 28)                   1652              dense_46[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_47 (CRF)                                     (None, 73, 11)                   275               dense_47[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_48 (CRF)                                     (None, 73, 5)                    65                dense_48[0][0]                                    
======================================================================================================================================================
Total params: 22,313,236
Trainable params: 22,313,236
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
None 




Train on 49616 samples, validate on 2258 samples
Epoch 1/25
 - 1672s - loss: 0.4343 - crf_46_loss: 0.2020 - crf_47_loss: 0.1507 - crf_48_loss: 0.0816 - crf_46_acc_1: 0.9375 - crf_46_acc_2: 0.7713 - crf_46_acc_3: 0.7747 - crf_47_acc_1: 0.7710 - crf_47_acc_2: 0.9260 - crf_47_acc_3: 0.7732 - crf_48_acc_1: 0.7733 - crf_48_acc_2: 0.7712 - crf_48_acc_3: 0.9702 - val_loss: 0.1481 - val_crf_46_loss: 0.0746 - val_crf_47_loss: 0.0550 - val_crf_48_loss: 0.0185 - val_crf_46_acc_1: 0.9708 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8135 - val_crf_47_acc_2: 0.9537 - val_crf_47_acc_3: 0.8153 - val_crf_48_acc_1: 0.8134 - val_crf_48_acc_2: 0.8148 - val_crf_48_acc_3: 0.9907 - val_f1: 0.8494 - val_crf_46_f1: 0.8436 - val_crf_47_f1: 0.7533 - val_crf_48_f1: 0.9513
Epoch 2/25
 - 1635s - loss: 0.1270 - crf_46_loss: 0.0677 - crf_47_loss: 0.0426 - crf_48_loss: 0.0168 - crf_46_acc_1: 0.9656 - crf_46_acc_2: 0.7723 - crf_46_acc_3: 0.7755 - crf_47_acc_1: 0.7722 - crf_47_acc_2: 0.9546 - crf_47_acc_3: 0.7736 - crf_48_acc_1: 0.7752 - crf_48_acc_2: 0.7730 - crf_48_acc_3: 0.9851 - val_loss: 0.0595 - val_crf_46_loss: 0.0354 - val_crf_47_loss: 0.0213 - val_crf_48_loss: 0.0028 - val_crf_46_acc_1: 0.9761 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8136 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9587 - val_crf_47_acc_3: 0.8154 - val_crf_48_acc_1: 0.8136 - val_crf_48_acc_2: 0.8157 - val_crf_48_acc_3: 0.9916 - val_f1: 0.8695 - val_crf_46_f1: 0.8752 - val_crf_47_f1: 0.7800 - val_crf_48_f1: 0.9533
Epoch 3/25
 - 1620s - loss: 0.0451 - crf_46_loss: 0.0341 - crf_47_loss: 0.0128 - crf_48_loss: -1.8353e-03 - crf_46_acc_1: 0.9702 - crf_46_acc_2: 0.7722 - crf_46_acc_3: 0.7754 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9602 - crf_47_acc_3: 0.7735 - crf_48_acc_1: 0.7752 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9871 - val_loss: 0.0117 - val_crf_46_loss: 0.0168 - val_crf_47_loss: 0.0042 - val_crf_48_loss: -9.3444e-03 - val_crf_46_acc_1: 0.9772 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8134 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9559 - val_crf_47_acc_3: 0.8155 - val_crf_48_acc_1: 0.8134 - val_crf_48_acc_2: 0.8147 - val_crf_48_acc_3: 0.9902 - val_f1: 0.8596 - val_crf_46_f1: 0.8795 - val_crf_47_f1: 0.7525 - val_crf_48_f1: 0.9467
Epoch 4/25
 - 1621s - loss: -6.5974e-03 - crf_46_loss: 0.0137 - crf_47_loss: -5.2085e-03 - crf_48_loss: -1.5135e-02 - crf_46_acc_1: 0.9729 - crf_46_acc_2: 0.7722 - crf_46_acc_3: 0.7754 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9641 - crf_47_acc_3: 0.7734 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9879 - val_loss: -2.5315e-02 - val_crf_46_loss: 0.0043 - val_crf_47_loss: -1.0875e-02 - val_crf_48_loss: -1.8708e-02 - val_crf_46_acc_1: 0.9761 - val_crf_46_acc_2: 0.8133 - val_crf_46_acc_3: 0.8136 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9624 - val_crf_47_acc_3: 0.8151 - val_crf_48_acc_1: 0.8135 - val_crf_48_acc_2: 0.8152 - val_crf_48_acc_3: 0.9892 - val_f1: 0.8737 - val_crf_46_f1: 0.8772 - val_crf_47_f1: 0.7997 - val_crf_48_f1: 0.9442
Epoch 5/25
 - 1618s - loss: -4.7658e-02 - crf_46_loss: -1.8808e-03 - crf_47_loss: -1.9121e-02 - crf_48_loss: -2.6657e-02 - crf_46_acc_1: 0.9749 - crf_46_acc_2: 0.7722 - crf_46_acc_3: 0.7754 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9670 - crf_47_acc_3: 0.7734 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9886 - val_loss: -5.8650e-02 - val_crf_46_loss: -7.7814e-03 - val_crf_47_loss: -2.2174e-02 - val_crf_48_loss: -2.8695e-02 - val_crf_46_acc_1: 0.9767 - val_crf_46_acc_2: 0.8129 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9655 - val_crf_47_acc_3: 0.8152 - val_crf_48_acc_1: 0.8133 - val_crf_48_acc_2: 0.8153 - val_crf_48_acc_3: 0.9895 - val_f1: 0.8790 - val_crf_46_f1: 0.8765 - val_crf_47_f1: 0.8170 - val_crf_48_f1: 0.9435
Epoch 6/25
 - 1619s - loss: -8.3934e-02 - crf_46_loss: -1.5201e-02 - crf_47_loss: -3.1246e-02 - crf_48_loss: -3.7487e-02 - crf_46_acc_1: 0.9765 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7754 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9702 - crf_47_acc_3: 0.7733 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9891 - val_loss: -8.9541e-02 - val_crf_46_loss: -1.9287e-02 - val_crf_47_loss: -3.2026e-02 - val_crf_48_loss: -3.8227e-02 - val_crf_46_acc_1: 0.9781 - val_crf_46_acc_2: 0.8129 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9657 - val_crf_47_acc_3: 0.8153 - val_crf_48_acc_1: 0.8134 - val_crf_48_acc_2: 0.8152 - val_crf_48_acc_3: 0.9886 - val_f1: 0.8800 - val_crf_46_f1: 0.8873 - val_crf_47_f1: 0.8169 - val_crf_48_f1: 0.9358
Epoch 7/25
 - 1619s - loss: -1.1807e-01 - crf_46_loss: -2.7441e-02 - crf_47_loss: -4.2580e-02 - crf_48_loss: -4.8051e-02 - crf_46_acc_1: 0.9783 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7753 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9728 - crf_47_acc_3: 0.7733 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9893 - val_loss: -1.1676e-01 - val_crf_46_loss: -2.7931e-02 - val_crf_47_loss: -4.1508e-02 - val_crf_48_loss: -4.7322e-02 - val_crf_46_acc_1: 0.9774 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9659 - val_crf_47_acc_3: 0.8151 - val_crf_48_acc_1: 0.8136 - val_crf_48_acc_2: 0.8151 - val_crf_48_acc_3: 0.9880 - val_f1: 0.8780 - val_crf_46_f1: 0.8809 - val_crf_47_f1: 0.8198 - val_crf_48_f1: 0.9333
Epoch 8/25
 - 1619s - loss: -1.5054e-01 - crf_46_loss: -3.8798e-02 - crf_47_loss: -5.3358e-02 - crf_48_loss: -5.8385e-02 - crf_46_acc_1: 0.9798 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7753 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9749 - crf_47_acc_3: 0.7733 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7731 - crf_48_acc_3: 0.9895 - val_loss: -1.4095e-01 - val_crf_46_loss: -3.5957e-02 - val_crf_47_loss: -4.9411e-02 - val_crf_48_loss: -5.5587e-02 - val_crf_46_acc_1: 0.9759 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9658 - val_crf_47_acc_3: 0.8153 - val_crf_48_acc_1: 0.8134 - val_crf_48_acc_2: 0.8151 - val_crf_48_acc_3: 0.9855 - val_f1: 0.8718 - val_crf_46_f1: 0.8769 - val_crf_47_f1: 0.8206 - val_crf_48_f1: 0.9181
Epoch 9/25
 - 1614s - loss: -1.8244e-01 - crf_46_loss: -4.9760e-02 - crf_47_loss: -6.3986e-02 - crf_48_loss: -6.8689e-02 - crf_46_acc_1: 0.9811 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7753 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9771 - crf_47_acc_3: 0.7732 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7730 - crf_48_acc_3: 0.9899 - val_loss: -1.7268e-01 - val_crf_46_loss: -4.6720e-02 - val_crf_47_loss: -5.9361e-02 - val_crf_48_loss: -6.6596e-02 - val_crf_46_acc_1: 0.9769 - val_crf_46_acc_2: 0.8131 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8134 - val_crf_47_acc_2: 0.9627 - val_crf_47_acc_3: 0.8151 - val_crf_48_acc_1: 0.8135 - val_crf_48_acc_2: 0.8151 - val_crf_48_acc_3: 0.9864 - val_f1: 0.8662 - val_crf_46_f1: 0.8788 - val_crf_47_f1: 0.8004 - val_crf_48_f1: 0.9195
Epoch 10/25
 - 1624s - loss: -2.1354e-01 - crf_46_loss: -6.0463e-02 - crf_47_loss: -7.4260e-02 - crf_48_loss: -7.8814e-02 - crf_46_acc_1: 0.9824 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7753 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9789 - crf_47_acc_3: 0.7732 - crf_48_acc_1: 0.7752 - crf_48_acc_2: 0.7730 - crf_48_acc_3: 0.9901 - val_loss: -1.9266e-01 - val_crf_46_loss: -5.2395e-02 - val_crf_47_loss: -6.6436e-02 - val_crf_48_loss: -7.3831e-02 - val_crf_46_acc_1: 0.9761 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8133 - val_crf_47_acc_2: 0.9637 - val_crf_47_acc_3: 0.8153 - val_crf_48_acc_1: 0.8135 - val_crf_48_acc_2: 0.8154 - val_crf_48_acc_3: 0.9848 - val_f1: 0.8673 - val_crf_46_f1: 0.8771 - val_crf_47_f1: 0.8094 - val_crf_48_f1: 0.9154
Epoch 11/25
 - 1636s - loss: -2.4426e-01 - crf_46_loss: -7.0800e-02 - crf_47_loss: -8.4549e-02 - crf_48_loss: -8.8914e-02 - crf_46_acc_1: 0.9834 - crf_46_acc_2: 0.7721 - crf_46_acc_3: 0.7753 - crf_47_acc_1: 0.7721 - crf_47_acc_2: 0.9807 - crf_47_acc_3: 0.7732 - crf_48_acc_1: 0.7753 - crf_48_acc_2: 0.7730 - crf_48_acc_3: 0.9903 - val_loss: -2.2572e-01 - val_crf_46_loss: -6.2490e-02 - val_crf_47_loss: -7.7645e-02 - val_crf_48_loss: -8.5585e-02 - val_crf_46_acc_1: 0.9748 - val_crf_46_acc_2: 0.8130 - val_crf_46_acc_3: 0.8135 - val_crf_47_acc_1: 0.8133 - val_crf_47_acc_2: 0.9638 - val_crf_47_acc_3: 0.8153 - val_crf_48_acc_1: 0.8134 - val_crf_48_acc_2: 0.8153 - val_crf_48_acc_3: 0.9862 - val_f1: 0.8659 - val_crf_46_f1: 0.8746 - val_crf_47_f1: 0.8086 - val_crf_48_f1: 0.9146

-------------------------------------------
Best F1 score: 0.880016959052   (epoch number 6)
For task 1
====================================================================================
With padding into account
                           precision    recall  f1-score   support

             abbreviation     0.8627    0.5946    0.7040       148
        archivalreference     0.8941    0.8511    0.8721       853
              archive_lib     0.9375    0.8738    0.9045       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9438    0.9303    0.9370      4948
                      box     0.8714    0.5545    0.6778       110
              cartulation     0.6667    1.0000    0.8000         8
              conjunction     0.5325    0.6716    0.5941       134
                     date     0.3946    1.0000    0.5659        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.4615    0.6429    0.5373        28
                foliation     0.6000    1.0000    0.7500        12
                     null     1.0000    1.0000    1.0000    133958
             numbered_ref     0.3117    0.2000    0.2437       120
                        o     0.2776    0.3883    0.3237       752
               pagination     0.9080    0.9789    0.9421      1139
   publicationnumber-year     0.7295    0.7972    0.7618       646
         publicationplace     0.9339    0.9234    0.9286      1592
publicationspecifications     0.4080    0.3280    0.3636       372
                publisher     0.9169    0.8406    0.8771      1443
                      ref     0.0909    0.6667    0.1600         3
                 registry     0.8000    0.1039    0.1839       154
                   series     0.9720    0.9085    0.9392       153
                    title     0.9401    0.9469    0.9435     15560
                     tomo     0.8704    0.4196    0.5663       224
                   volume     0.5041    0.6715    0.5759       277
                     year     0.9410    0.7834    0.8550      2036

              avg / total     0.9810    0.9781    0.9789    164834


----------------------------------------------

Without the padding:
                           precision    recall  f1-score   support

             abbreviation     0.8627    0.5946    0.7040       148
        archivalreference     0.8941    0.8511    0.8721       853
              archive_lib     0.9375    0.8738    0.9045       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9438    0.9303    0.9370      4948
                      box     0.8714    0.5545    0.6778       110
              cartulation     0.6667    1.0000    0.8000         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5325    0.6716    0.5941       134
                     date     0.3946    1.0000    0.5659        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.4615    0.6429    0.5373        28
                foliation     0.6000    1.0000    0.7500        12
             numbered_ref     0.3117    0.2000    0.2437       120
                        o     0.2776    0.3883    0.3237       752
               pagination     0.9080    0.9789    0.9421      1139
   publicationnumber-year     0.7295    0.7972    0.7618       646
         publicationplace     0.9339    0.9234    0.9286      1592
publicationspecifications     0.4080    0.3280    0.3636       372
                publisher     0.9169    0.8406    0.8771      1443
                      ref     0.0909    0.6667    0.1600         3
                 registry     0.8000    0.1039    0.1839       154
                   series     0.9720    0.9085    0.9392       153
                    title     0.9401    0.9469    0.9435     15560
                     tomo     0.8704    0.4196    0.5663       224
                   volume     0.5041    0.6715    0.5759       277
                     year     0.9410    0.7834    0.8550      2036

              avg / total     0.8984    0.8833    0.8873     30876



For task 2
====================================================================================
With padding into account
                   precision    recall  f1-score   support

b-meta-annotation     0.7258    0.6236    0.6708       348
        b-primary     0.4865    0.1714    0.2535       105
      b-secondary     0.7324    0.6585    0.6934       852
e-meta-annotation     0.8715    0.7418    0.8014      1061
        e-primary     0.4490    0.5133    0.4790       300
      e-secondary     0.8265    0.8544    0.8402      1717
i-meta-annotation     0.8196    0.8141    0.8169      9981
        i-primary     0.8224    0.6510    0.7267      1728
      i-secondary     0.8486    0.8744    0.8613     14357
             null     1.0000    1.0000    1.0000    133958
                o     0.3072    0.4871    0.3768       427

      avg / total     0.9663    0.9657    0.9657    164834


----------------------------------------------

Without the padding:
                   precision    recall  f1-score   support

b-meta-annotation     0.7258    0.6236    0.6708       348
        b-primary     0.4865    0.1714    0.2535       105
      b-secondary     0.7324    0.6585    0.6934       852
e-meta-annotation     0.8715    0.7418    0.8014      1061
        e-primary     0.4490    0.5133    0.4790       300
      e-secondary     0.8265    0.8544    0.8402      1717
i-meta-annotation     0.8196    0.8141    0.8169      9981
        i-primary     0.8224    0.6510    0.7267      1728
      i-secondary     0.8486    0.8744    0.8613     14357
                o     0.3072    0.4871    0.3768       427

      avg / total     0.8201    0.8167    0.8169     30876



For task 3
====================================================================================
With padding into account
             precision    recall  f1-score   support

        b-r     0.8180    0.6751    0.7397      1305
        e-r     0.9232    0.4221    0.5794      1310
        i-r     0.9574    0.9830    0.9700     27834
       null     1.0000    1.0000    1.0000    133958
          o     0.3371    0.4895    0.3992       427

avg / total     0.9890    0.9886    0.9880    164834


----------------------------------------------

Without the padding:
             precision    recall  f1-score   support

        b-r     0.8180    0.6751    0.7397      1305
        e-r     0.9232    0.4221    0.5794      1310
        i-r     0.9574    0.9830    0.9700     27834
          o     0.3371    0.4895    0.3992       427

avg / total     0.9415    0.9394    0.9358     30876




Confusion matrix, without normalization
[[    36      0     88     24      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    10     19    807     17      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    15      0     81      7      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   876      3   4052     17      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1    109      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      8      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    131      3      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0     58      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      2     25      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0     12      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0 133958      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      3    106     10      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     9      4    520    219      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0    158    945     36      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      6    639      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      2   1589      1      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    349     23      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      0   1442      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     3      0    151      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    153      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   117      6  15347     90      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    224      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1    275      1      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     7    394   1463    172      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]]
Normalized confusion matrix
[[  2.43243243e-01   0.00000000e+00   5.94594595e-01   1.62162162e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.17233294e-02   2.22743259e-02   9.46072685e-01   1.99296600e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.45631068e-01   0.00000000e+00   7.86407767e-01   6.79611650e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [             nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan]
 [  1.77041229e-01   6.06305578e-04   8.18916734e-01   3.43573161e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   9.09090909e-03   9.90909091e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.77611940e-01   2.23880597e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.57142857e-02   7.14285714e-02   8.92857143e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    1.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.33333333e-03   2.50000000e-02   8.83333333e-01   8.33333333e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.19680851e-02   5.31914894e-03   6.91489362e-01   2.91223404e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.38718174e-01   8.29675154e-01   3.16066725e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.54798762e-03   9.28792570e-03   9.89164087e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.25628141e-03   9.98115578e-01   6.28140704e-04
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.38172043e-01   6.18279570e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.93000693e-04   0.00000000e+00   9.99306999e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.94805195e-02   0.00000000e+00   9.80519481e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.51928021e-03   3.85604113e-04   9.86311054e-01   5.78406170e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   3.61010830e-03   9.92779783e-01   3.61010830e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.43811395e-03   1.93516699e-01   7.18565815e-01   8.44793713e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   260      0     51     37      0      0      0      0      0      0
       0]
 [    22      0     81      2      0      0      0      0      0      0
       0]
 [   599      0    142    111      0      0      0      0      0      0
       0]
 [     0    184    849     28      0      0      0      0      0      0
       0]
 [     0      3    286     11      0      0      0      0      0      0
       0]
 [     1    366   1332     18      0      0      0      0      0      0
       0]
 [    48      4   9847     82      0      0      0      0      0      0
       0]
 [    23     25   1648     32      0      0      0      0      0      0
       0]
 [   118     13  14136     90      0      0      0      0      0      0
       0]
 [     0      0      0      0      0      0      0      0      0 133958
       0]
 [     6      4    208    209      0      0      0      0      0      0
       0]]
Normalized confusion matrix
[[  7.47126437e-01   0.00000000e+00   1.46551724e-01   1.06321839e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  2.09523810e-01   0.00000000e+00   7.71428571e-01   1.90476190e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.03051643e-01   0.00000000e+00   1.66666667e-01   1.30281690e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.73421301e-01   8.00188501e-01   2.63901979e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.00000000e-02   9.53333333e-01   3.66666667e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.82411182e-04   2.13162493e-01   7.75771695e-01   1.04834013e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  4.80913736e-03   4.00761447e-04   9.86574492e-01   8.21560966e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.33101852e-02   1.44675926e-02   9.53703704e-01   1.85185185e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.21898725e-03   9.05481647e-04   9.84606812e-01   6.26871909e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   1.00000000e+00   0.00000000e+00]
 [  1.40515222e-02   9.36768150e-03   4.87119438e-01   4.89461358e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   881      0    274      0    150]
 [     0    553    736      0     21]
 [   190     42  27362      0    240]
 [     0      0      0 133958      0]
 [     6      4    208      0    209]]
Normalized confusion matrix
[[ 0.67509579  0.          0.20996169  0.          0.11494253]
 [ 0.          0.4221374   0.56183206  0.          0.01603053]
 [ 0.00682618  0.00150895  0.98304232  0.          0.00862255]
 [ 0.          0.          0.          1.          0.        ]
 [ 0.01405152  0.00936768  0.48711944  0.          0.48946136]]
