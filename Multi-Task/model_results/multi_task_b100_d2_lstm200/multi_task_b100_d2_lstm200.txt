______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_14 (InputLayer)                            (None, 73, 54)                   0                                                                   
______________________________________________________________________________________________________________________________________________________
char_embedding (TimeDistributed)                 (None, 73, 54, 100)              16500             input_14[0][0]                                    
______________________________________________________________________________________________________________________________________________________
dropout_19 (Dropout)                             (None, 73, 54, 100)              0                 char_embedding[0][0]                              
______________________________________________________________________________________________________________________________________________________
input_13 (InputLayer)                            (None, 73)                       0                                                                   
______________________________________________________________________________________________________________________________________________________
time_distributed_13 (TimeDistributed)            (None, 73, 54, 50)               25200             dropout_19[0][0]                                  
______________________________________________________________________________________________________________________________________________________
embedding_13 (Embedding)                         (None, 73, 300)                  17130300          input_13[0][0]                                    
______________________________________________________________________________________________________________________________________________________
time_distributed_14 (TimeDistributed)            (None, 73, 2700)                 0                 time_distributed_13[0][0]                         
______________________________________________________________________________________________________________________________________________________
concatenate_7 (Concatenate)                      (None, 73, 3000)                 0                 embedding_13[0][0]                                
                                                                                                    time_distributed_14[0][0]                         
______________________________________________________________________________________________________________________________________________________
dropout_20 (Dropout)                             (None, 73, 3000)                 0                 concatenate_7[0][0]                               
______________________________________________________________________________________________________________________________________________________
bidirectional_14 (Bidirectional)                 (None, 73, 400)                  5121600           dropout_20[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dropout_21 (Dropout)                             (None, 73, 400)                  0                 bidirectional_14[0][0]                            
______________________________________________________________________________________________________________________________________________________
dense_19 (Dense)                                 (None, 73, 28)                   11228             dropout_21[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_20 (Dense)                                 (None, 73, 11)                   4411              dropout_21[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense_21 (Dense)                                 (None, 73, 5)                    2005              dropout_21[0][0]                                  
______________________________________________________________________________________________________________________________________________________
crf_19 (CRF)                                     (None, 73, 28)                   1652              dense_19[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_20 (CRF)                                     (None, 73, 11)                   275               dense_20[0][0]                                    
______________________________________________________________________________________________________________________________________________________
crf_21 (CRF)                                     (None, 73, 5)                    65                dense_21[0][0]                                    
======================================================================================================================================================
Total params: 22,313,236
Trainable params: 22,313,236
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
None 




Train on 49616 samples, validate on 2258 samples
Epoch 1/25
 - 1489s - loss: 0.4993 - crf_19_loss: 0.2304 - crf_20_loss: 0.1858 - crf_21_loss: 0.0831 - crf_19_acc_1: 0.9304 - crf_19_acc_2: 0.7711 - crf_19_acc_3: 0.7746 - crf_20_acc_1: 0.7706 - crf_20_acc_2: 0.9198 - crf_20_acc_3: 0.7733 - crf_21_acc_1: 0.7724 - crf_21_acc_2: 0.7708 - crf_21_acc_3: 0.9666 - val_loss: 0.2137 - val_crf_19_loss: 0.0987 - val_crf_20_loss: 0.0900 - val_crf_21_loss: 0.0250 - val_crf_19_acc_1: 0.9643 - val_crf_19_acc_2: 0.8132 - val_crf_19_acc_3: 0.8134 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9415 - val_crf_20_acc_3: 0.8150 - val_crf_21_acc_1: 0.8136 - val_crf_21_acc_2: 0.8147 - val_crf_21_acc_3: 0.9863 - val_f1: 0.8089 - val_crf_19_f1: 0.8225 - val_crf_20_f1: 0.6690 - val_crf_21_f1: 0.9352
Epoch 2/25
 - 1465s - loss: 0.1670 - crf_19_loss: 0.0831 - crf_20_loss: 0.0632 - crf_21_loss: 0.0207 - crf_19_acc_1: 0.9640 - crf_19_acc_2: 0.7723 - crf_19_acc_3: 0.7756 - crf_20_acc_1: 0.7722 - crf_20_acc_2: 0.9535 - crf_20_acc_3: 0.7737 - crf_21_acc_1: 0.7752 - crf_21_acc_2: 0.7730 - crf_21_acc_3: 0.9838 - val_loss: 0.0985 - val_crf_19_loss: 0.0477 - val_crf_20_loss: 0.0434 - val_crf_21_loss: 0.0074 - val_crf_19_acc_1: 0.9760 - val_crf_19_acc_2: 0.8129 - val_crf_19_acc_3: 0.8134 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9480 - val_crf_20_acc_3: 0.8158 - val_crf_21_acc_1: 0.8137 - val_crf_21_acc_2: 0.8153 - val_crf_21_acc_3: 0.9897 - val_f1: 0.8447 - val_crf_19_f1: 0.8692 - val_crf_20_f1: 0.7222 - val_crf_21_f1: 0.9426
Epoch 3/25
 - 1468s - loss: 0.0837 - crf_19_loss: 0.0491 - crf_20_loss: 0.0300 - crf_21_loss: 0.0046 - crf_19_acc_1: 0.9692 - crf_19_acc_2: 0.7723 - crf_19_acc_3: 0.7754 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9604 - crf_20_acc_3: 0.7735 - crf_21_acc_1: 0.7752 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9861 - val_loss: 0.0488 - val_crf_19_loss: 0.0336 - val_crf_20_loss: 0.0166 - val_crf_21_loss: -1.3063e-03 - val_crf_19_acc_1: 0.9721 - val_crf_19_acc_2: 0.8130 - val_crf_19_acc_3: 0.8135 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9606 - val_crf_20_acc_3: 0.8153 - val_crf_21_acc_1: 0.8134 - val_crf_21_acc_2: 0.8152 - val_crf_21_acc_3: 0.9879 - val_f1: 0.8652 - val_crf_19_f1: 0.8634 - val_crf_20_f1: 0.7961 - val_crf_21_f1: 0.9361
Epoch 4/25
 - 1468s - loss: 0.0334 - crf_19_loss: 0.0289 - crf_20_loss: 0.0109 - crf_21_loss: -6.4050e-03 - crf_19_acc_1: 0.9720 - crf_19_acc_2: 0.7722 - crf_19_acc_3: 0.7754 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9646 - crf_20_acc_3: 0.7734 - crf_21_acc_1: 0.7752 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9871 - val_loss: 0.0112 - val_crf_19_loss: 0.0163 - val_crf_20_loss: 0.0058 - val_crf_21_loss: -1.0781e-02 - val_crf_19_acc_1: 0.9792 - val_crf_19_acc_2: 0.8130 - val_crf_19_acc_3: 0.8135 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9586 - val_crf_20_acc_3: 0.8154 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8148 - val_crf_21_acc_3: 0.9900 - val_f1: 0.8664 - val_crf_19_f1: 0.8842 - val_crf_20_f1: 0.7703 - val_crf_21_f1: 0.9447
Epoch 5/25
 - 1465s - loss: -3.7046e-03 - crf_19_loss: 0.0143 - crf_20_loss: -2.3994e-03 - crf_21_loss: -1.5591e-02 - crf_19_acc_1: 0.9743 - crf_19_acc_2: 0.7722 - crf_19_acc_3: 0.7754 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9675 - crf_20_acc_3: 0.7734 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9878 - val_loss: -1.1026e-02 - val_crf_19_loss: 0.0093 - val_crf_20_loss: -4.6182e-03 - val_crf_21_loss: -1.5755e-02 - val_crf_19_acc_1: 0.9763 - val_crf_19_acc_2: 0.8130 - val_crf_19_acc_3: 0.8136 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9579 - val_crf_20_acc_3: 0.8154 - val_crf_21_acc_1: 0.8139 - val_crf_21_acc_2: 0.8149 - val_crf_21_acc_3: 0.9855 - val_f1: 0.8567 - val_crf_19_f1: 0.8763 - val_crf_20_f1: 0.7704 - val_crf_21_f1: 0.9234
Epoch 6/25
 - 1465s - loss: -3.4565e-02 - crf_19_loss: 0.0025 - crf_20_loss: -1.3216e-02 - crf_21_loss: -2.3835e-02 - crf_19_acc_1: 0.9760 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9702 - crf_20_acc_3: 0.7733 - crf_21_acc_1: 0.7752 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9881 - val_loss: -4.1957e-02 - val_crf_19_loss: 4.2992e-05 - val_crf_20_loss: -1.6583e-02 - val_crf_21_loss: -2.5417e-02 - val_crf_19_acc_1: 0.9770 - val_crf_19_acc_2: 0.8130 - val_crf_19_acc_3: 0.8134 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9644 - val_crf_20_acc_3: 0.8151 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8155 - val_crf_21_acc_3: 0.9884 - val_f1: 0.8756 - val_crf_19_f1: 0.8792 - val_crf_20_f1: 0.8133 - val_crf_21_f1: 0.9343
Epoch 7/25
 - 1482s - loss: -6.2203e-02 - crf_19_loss: -7.8411e-03 - crf_20_loss: -2.2674e-02 - crf_21_loss: -3.1688e-02 - crf_19_acc_1: 0.9777 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9729 - crf_20_acc_3: 0.7733 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9884 - val_loss: -5.3498e-02 - val_crf_19_loss: -1.4926e-03 - val_crf_20_loss: -2.2126e-02 - val_crf_21_loss: -2.9880e-02 - val_crf_19_acc_1: 0.9715 - val_crf_19_acc_2: 0.8129 - val_crf_19_acc_3: 0.8135 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9640 - val_crf_20_acc_3: 0.8154 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8150 - val_crf_21_acc_3: 0.9855 - val_f1: 0.8612 - val_crf_19_f1: 0.8570 - val_crf_20_f1: 0.8111 - val_crf_21_f1: 0.9156
Epoch 8/25
 - 1469s - loss: -8.7922e-02 - crf_19_loss: -1.7305e-02 - crf_20_loss: -3.1293e-02 - crf_21_loss: -3.9324e-02 - crf_19_acc_1: 0.9792 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9750 - crf_20_acc_3: 0.7733 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9888 - val_loss: -7.5256e-02 - val_crf_19_loss: -1.2306e-02 - val_crf_20_loss: -2.7558e-02 - val_crf_21_loss: -3.5391e-02 - val_crf_19_acc_1: 0.9783 - val_crf_19_acc_2: 0.8129 - val_crf_19_acc_3: 0.8136 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9653 - val_crf_20_acc_3: 0.8152 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8154 - val_crf_21_acc_3: 0.9870 - val_f1: 0.8743 - val_crf_19_f1: 0.8850 - val_crf_20_f1: 0.8148 - val_crf_21_f1: 0.9231
Epoch 9/25
 - 1480s - loss: -1.1235e-01 - crf_19_loss: -2.6058e-02 - crf_20_loss: -3.9459e-02 - crf_21_loss: -4.6836e-02 - crf_19_acc_1: 0.9805 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9770 - crf_20_acc_3: 0.7732 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7731 - crf_21_acc_3: 0.9892 - val_loss: -9.5034e-02 - val_crf_19_loss: -1.7861e-02 - val_crf_20_loss: -3.4705e-02 - val_crf_21_loss: -4.2467e-02 - val_crf_19_acc_1: 0.9751 - val_crf_19_acc_2: 0.8131 - val_crf_19_acc_3: 0.8135 - val_crf_20_acc_1: 0.8133 - val_crf_20_acc_2: 0.9607 - val_crf_20_acc_3: 0.8153 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8155 - val_crf_21_acc_3: 0.9844 - val_f1: 0.8593 - val_crf_19_f1: 0.8748 - val_crf_20_f1: 0.7959 - val_crf_21_f1: 0.9072
Epoch 10/25
 - 1468s - loss: -1.3605e-01 - crf_19_loss: -3.4536e-02 - crf_20_loss: -4.7293e-02 - crf_21_loss: -5.4224e-02 - crf_19_acc_1: 0.9816 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9790 - crf_20_acc_3: 0.7732 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7730 - crf_21_acc_3: 0.9897 - val_loss: -1.1815e-01 - val_crf_19_loss: -2.5397e-02 - val_crf_20_loss: -4.2412e-02 - val_crf_21_loss: -5.0340e-02 - val_crf_19_acc_1: 0.9758 - val_crf_19_acc_2: 0.8130 - val_crf_19_acc_3: 0.8135 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9621 - val_crf_20_acc_3: 0.8154 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8154 - val_crf_21_acc_3: 0.9858 - val_f1: 0.8617 - val_crf_19_f1: 0.8750 - val_crf_20_f1: 0.8012 - val_crf_21_f1: 0.9088
Epoch 11/25
 - 1466s - loss: -1.5924e-01 - crf_19_loss: -4.2649e-02 - crf_20_loss: -5.5049e-02 - crf_21_loss: -6.1547e-02 - crf_19_acc_1: 0.9828 - crf_19_acc_2: 0.7721 - crf_19_acc_3: 0.7753 - crf_20_acc_1: 0.7721 - crf_20_acc_2: 0.9811 - crf_20_acc_3: 0.7732 - crf_21_acc_1: 0.7753 - crf_21_acc_2: 0.7730 - crf_21_acc_3: 0.9900 - val_loss: -1.3349e-01 - val_crf_19_loss: -3.1602e-02 - val_crf_20_loss: -4.6824e-02 - val_crf_21_loss: -5.5066e-02 - val_crf_19_acc_1: 0.9766 - val_crf_19_acc_2: 0.8129 - val_crf_19_acc_3: 0.8136 - val_crf_20_acc_1: 0.8134 - val_crf_20_acc_2: 0.9647 - val_crf_20_acc_3: 0.8155 - val_crf_21_acc_1: 0.8135 - val_crf_21_acc_2: 0.8150 - val_crf_21_acc_3: 0.9853 - val_f1: 0.8669 - val_crf_19_f1: 0.8775 - val_crf_20_f1: 0.8109 - val_crf_21_f1: 0.9125

-------------------------------------------
Best F1 score: 0.87560991696   (epoch number 6)
For task 1
====================================================================================
With padding into account
                           precision    recall  f1-score   support

             abbreviation     0.9111    0.5541    0.6891       148
        archivalreference     0.7809    0.8523    0.8150       853
              archive_lib     0.8163    0.7767    0.7960       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9433    0.9274    0.9353      4948
                      box     0.5714    0.1091    0.1832       110
              cartulation     0.3077    1.0000    0.4706         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5172    0.6716    0.5844       134
                     date     0.3537    1.0000    0.5225        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.1797    0.8214    0.2949        28
                foliation     0.5000    1.0000    0.6667        12
                     null     1.0000    1.0000    1.0000    133958
             numbered_ref     0.2651    0.1833    0.2167       120
                        o     0.2481    0.3005    0.2718       752
               pagination     0.9132    0.9508    0.9316      1139
   publicationnumber-year     0.7381    0.7678    0.7527       646
         publicationplace     0.9299    0.9334    0.9317      1592
publicationspecifications     0.3557    0.4409    0.3938       372
                publisher     0.9056    0.8711    0.8880      1443
                      ref     0.2500    0.6667    0.3636         3
                 registry     1.0000    0.1039    0.1882       154
                   series     0.9370    0.7778    0.8500       153
                    title     0.9386    0.9413    0.9399     15560
                     tomo     0.7982    0.3884    0.5225       224
                   volume     0.5429    0.4801    0.5096       277
                     year     0.9154    0.8134    0.8614      2036

              avg / total     0.9793    0.9770    0.9774    164834


----------------------------------------------

Without the padding:
                           precision    recall  f1-score   support

             abbreviation     0.9111    0.5541    0.6891       148
        archivalreference     0.7809    0.8523    0.8150       853
              archive_lib     0.8163    0.7767    0.7960       103
               attachment     0.0000    0.0000    0.0000         0
                   author     0.9433    0.9274    0.9353      4948
                      box     0.5714    0.1091    0.1832       110
              cartulation     0.3077    1.0000    0.4706         8
                   column     0.0000    0.0000    0.0000         0
              conjunction     0.5172    0.6716    0.5844       134
                     date     0.3537    1.0000    0.5225        58
                    filza     1.0000    1.0000    1.0000         3
                   folder     0.1797    0.8214    0.2949        28
                foliation     0.5000    1.0000    0.6667        12
             numbered_ref     0.2651    0.1833    0.2167       120
                        o     0.2481    0.3005    0.2718       752
               pagination     0.9132    0.9508    0.9316      1139
   publicationnumber-year     0.7381    0.7678    0.7527       646
         publicationplace     0.9299    0.9334    0.9317      1592
publicationspecifications     0.3557    0.4409    0.3938       372
                publisher     0.9056    0.8711    0.8880      1443
                      ref     0.2500    0.6667    0.3636         3
                 registry     1.0000    0.1039    0.1882       154
                   series     0.9370    0.7778    0.8500       153
                    title     0.9386    0.9413    0.9399     15560
                     tomo     0.7982    0.3884    0.5225       224
                   volume     0.5429    0.4801    0.5096       277
                     year     0.9154    0.8134    0.8614      2036

              avg / total     0.8898    0.8770    0.8792     30876



For task 2
====================================================================================
With padding into account
                   precision    recall  f1-score   support

b-meta-annotation     0.6462    0.7241    0.6829       348
        b-primary     0.5079    0.3048    0.3810       105
      b-secondary     0.8040    0.6549    0.7219       852
e-meta-annotation     0.8476    0.7861    0.8156      1061
        e-primary     0.6037    0.6600    0.6306       300
      e-secondary     0.8628    0.8497    0.8562      1717
i-meta-annotation     0.7702    0.8652    0.8149      9981
        i-primary     0.6702    0.8513    0.7499      1728
      i-secondary     0.9032    0.7926    0.8443     14357
             null     1.0000    1.0000    1.0000    133958
                o     0.2688    0.4520    0.3371       427

      avg / total     0.9671    0.9644    0.9650    164834


----------------------------------------------

Without the padding:
                   precision    recall  f1-score   support

b-meta-annotation     0.6462    0.7241    0.6829       348
        b-primary     0.5079    0.3048    0.3810       105
      b-secondary     0.8040    0.6549    0.7219       852
e-meta-annotation     0.8476    0.7861    0.8156      1061
        e-primary     0.6037    0.6600    0.6306       300
      e-secondary     0.8628    0.8497    0.8562      1717
i-meta-annotation     0.7702    0.8652    0.8149      9981
        i-primary     0.6702    0.8513    0.7499      1728
      i-secondary     0.9032    0.7926    0.8443     14357
                o     0.2688    0.4520    0.3371       427

      avg / total     0.8243    0.8101    0.8133     30876



For task 3
====================================================================================
With padding into account
             precision    recall  f1-score   support

        b-r     0.8351    0.7257    0.7765      1305
        e-r     0.9294    0.3817    0.5411      1310
        i-r     0.9570    0.9816    0.9691     27834
       null     1.0000    1.0000    1.0000    133958
          o     0.2936    0.4496    0.3552       427

avg / total     0.9890    0.9884    0.9877    164834


----------------------------------------------

Without the padding:
             precision    recall  f1-score   support

        b-r     0.8351    0.7257    0.7765      1305
        e-r     0.9294    0.3817    0.5411      1310
        i-r     0.9570    0.9816    0.9691     27834
          o     0.2936    0.4496    0.3552       427

avg / total     0.9415    0.9379    0.9343     30876




Confusion matrix, without normalization
[[    36      0     92     20      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    13     11    820      9      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    18      0     74     11      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   902      2   4009     35      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    110      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1      7      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    132      2      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1     57      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      1     26      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1     11      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      0      0      0      0      0      0      0      0
       0      0 133958      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      3    109      6      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     9      5    525    213      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0    138    967     34      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      6    635      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     1      2   1588      1      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    355     17      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     3      0   1436      4      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0      3      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     2      0    152      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    153      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [   128      9  15289    134      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      0    224      0      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [     0      1    275      1      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]
 [    18    357   1498    163      0      0      0      0      0      0
       0      0      0      0      0      0      0      0      0      0
       0      0      0      0      0      0      0]]
Normalized confusion matrix
[[  2.43243243e-01   0.00000000e+00   6.21621622e-01   1.35135135e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.52403283e-02   1.28956624e-02   9.61313013e-01   1.05509965e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.74757282e-01   0.00000000e+00   7.18446602e-01   1.06796117e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [             nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan              nan
               nan              nan              nan]
 [  1.82295877e-01   4.04203719e-04   8.10226354e-01   7.07356508e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.25000000e-01   8.75000000e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.85074627e-01   1.49253731e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.72413793e-02   9.82758621e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.57142857e-02   3.57142857e-02   9.28571429e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   8.33333333e-02   9.16666667e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    1.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.66666667e-02   2.50000000e-02   9.08333333e-01   5.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.19680851e-02   6.64893617e-03   6.98138298e-01   2.83244681e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.21158911e-01   8.48990342e-01   2.98507463e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.54798762e-03   9.28792570e-03   9.82972136e-01   6.19195046e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.28140704e-04   1.25628141e-03   9.97487437e-01   6.28140704e-04
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   9.54301075e-01   4.56989247e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  2.07900208e-03   0.00000000e+00   9.95148995e-01   2.77200277e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  1.29870130e-02   0.00000000e+00   9.87012987e-01   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.22622108e-03   5.78406170e-04   9.82583548e-01   8.61182519e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   1.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   3.61010830e-03   9.92779783e-01   3.61010830e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.84086444e-03   1.75343811e-01   7.35756385e-01   8.00589391e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   267      0     41     40      0      0      0      0      0      0
       0]
 [    27      0     77      1      0      0      0      0      0      0
       0]
 [   653      0     99    100      0      0      0      0      0      0
       0]
 [     0    166    867     28      0      0      0      0      0      0
       0]
 [     1      3    275     21      0      0      0      0      0      0
       0]
 [     0    331   1372     14      0      0      0      0      0      0
       0]
 [    53      6   9837     85      0      0      0      0      0      0
       0]
 [    12     18   1641     57      0      0      0      0      0      0
       0]
 [   115     10  14116    116      0      0      0      0      0      0
       0]
 [     0      0      0      0      0      0      0      0      0 133958
       0]
 [     6      4    225    192      0      0      0      0      0      0
       0]]
Normalized confusion matrix
[[  7.67241379e-01   0.00000000e+00   1.17816092e-01   1.14942529e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  2.57142857e-01   0.00000000e+00   7.33333333e-01   9.52380952e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  7.66431925e-01   0.00000000e+00   1.16197183e-01   1.17370892e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.56456173e-01   8.17153629e-01   2.63901979e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  3.33333333e-03   1.00000000e-02   9.16666667e-01   7.00000000e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.92778101e-01   7.99068142e-01   8.15375655e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  5.31008917e-03   6.01142170e-04   9.85572588e-01   8.51618074e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  6.94444444e-03   1.04166667e-02   9.49652778e-01   3.29861111e-02
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  8.01002995e-03   6.96524344e-04   9.83213763e-01   8.07968238e-03
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   1.00000000e+00   0.00000000e+00]
 [  1.40515222e-02   9.36768150e-03   5.26932084e-01   4.49648712e-01
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00]]
Confusion matrix, without normalization
[[   947      0    217      0    141]
 [     0    500    787      0     23]
 [   181     34  27321      0    298]
 [     0      0      0 133958      0]
 [     6      4    225      0    192]]
Normalized confusion matrix
[[ 0.7256705   0.          0.16628352  0.          0.10804598]
 [ 0.          0.38167939  0.60076336  0.          0.01755725]
 [ 0.00650284  0.00122153  0.9815693   0.          0.01070633]
 [ 0.          0.          0.          1.          0.        ]
 [ 0.01405152  0.00936768  0.52693208  0.          0.44964871]]
